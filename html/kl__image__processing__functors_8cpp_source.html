<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>klImageCore: kl_image_processing_functors.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>kl_image_processing_functors.cpp</h1>  </div>
</div>
<div class="contents">
<a href="kl__image__processing__functors_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*******************************</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c) &lt;2007&gt;, &lt;Bruce Campbell&gt; All rights reserved. Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met: 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  *  </span>
<a name="l00003"></a>00003 <span class="comment"> * Bruce B Campbell 11 30 2012  *</span>
<a name="l00004"></a>00004 <span class="comment"> ********************************/</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &quot;<a class="code" href="kl__image__processing__functors_8h.html">kl_image_processing_functors.h</a>&quot;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &quot;<a class="code" href="ppm__helper_8h.html">ppm_helper.h</a>&quot;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &quot;<a class="code" href="kl__img__pca_8h.html">kl_img_pca.h</a>&quot;</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 klMutex klThreadMap::lock;
<a name="l00010"></a>00010 map&lt;klThreadId, unsigned long&gt; klThreadMap::threadMap;
<a name="l00011"></a>00011 
<a name="l00012"></a><a class="code" href="classkl_pad_functor.html#a2e9931cba60f2589766146f2220d1205">00012</a> <span class="keywordtype">void</span> <a class="code" href="classkl_pad_functor.html#a2e9931cba60f2589766146f2220d1205">klPadFunctor::operator()</a>(<span class="keywordtype">void</span>)
<a name="l00013"></a>00013 {
<a name="l00014"></a>00014     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* outbuf=<a class="code" href="classkl_pad_functor.html#afede6cb518dec216ce9b6de2475005b4">dst</a>-&gt;buffer();
<a name="l00015"></a>00015     <span class="keywordtype">size_t</span> outbands=<a class="code" href="classkl_pad_functor.html#afede6cb518dec216ce9b6de2475005b4">dst</a>-&gt;numBands();
<a name="l00016"></a>00016     <span class="keywordtype">size_t</span> outwidth =<a class="code" href="classkl_pad_functor.html#afede6cb518dec216ce9b6de2475005b4">dst</a>-&gt;width();
<a name="l00017"></a>00017     <span class="keywordtype">size_t</span> outheight=<a class="code" href="classkl_pad_functor.html#afede6cb518dec216ce9b6de2475005b4">dst</a>-&gt;height(); 
<a name="l00018"></a>00018     <span class="keywordtype">size_t</span> outbandStride=<a class="code" href="classkl_pad_functor.html#afede6cb518dec216ce9b6de2475005b4">dst</a>-&gt;bandStride();
<a name="l00019"></a>00019     <span class="keywordtype">size_t</span> outxStride =<a class="code" href="classkl_pad_functor.html#afede6cb518dec216ce9b6de2475005b4">dst</a>-&gt;xStride();
<a name="l00020"></a>00020     <span class="keywordtype">size_t</span> outyStride= <a class="code" href="classkl_pad_functor.html#afede6cb518dec216ce9b6de2475005b4">dst</a>-&gt;yStride();
<a name="l00021"></a>00021 
<a name="l00022"></a>00022     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* inbuf=<a class="code" href="classkl_pad_functor.html#a96a63ef107527ce02f961bbdc61543b1">src</a>-&gt;buffer();
<a name="l00023"></a>00023     <span class="keywordtype">size_t</span> inbands=<a class="code" href="classkl_pad_functor.html#a96a63ef107527ce02f961bbdc61543b1">src</a>-&gt;numBands();
<a name="l00024"></a>00024     <span class="keywordtype">size_t</span> inwidth =<a class="code" href="classkl_pad_functor.html#a96a63ef107527ce02f961bbdc61543b1">src</a>-&gt;width();
<a name="l00025"></a>00025     <span class="keywordtype">size_t</span> inheight=<a class="code" href="classkl_pad_functor.html#a96a63ef107527ce02f961bbdc61543b1">src</a>-&gt;height(); 
<a name="l00026"></a>00026     <span class="keywordtype">size_t</span> inbandStride=<a class="code" href="classkl_pad_functor.html#a96a63ef107527ce02f961bbdc61543b1">src</a>-&gt;bandStride();
<a name="l00027"></a>00027     <span class="keywordtype">size_t</span> inxStride =<a class="code" href="classkl_pad_functor.html#a96a63ef107527ce02f961bbdc61543b1">src</a>-&gt;xStride();
<a name="l00028"></a>00028     <span class="keywordtype">size_t</span> inyStride= <a class="code" href="classkl_pad_functor.html#a96a63ef107527ce02f961bbdc61543b1">src</a>-&gt;yStride();
<a name="l00029"></a>00029 
<a name="l00030"></a>00030     <span class="keywordtype">size_t</span> writeBytes=outxStride/outbands;
<a name="l00031"></a>00031 
<a name="l00032"></a>00032     <span class="keywordflow">if</span>(outbands!=inbands )
<a name="l00033"></a>00033         <span class="keywordflow">throw</span> <span class="stringliteral">&quot;klPadFunctor: in and out bands should be the same for input and output buffers.&quot;</span>;
<a name="l00034"></a>00034 
<a name="l00035"></a>00035     <span class="comment">//First fill the roi</span>
<a name="l00036"></a>00036     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;
<a name="l00037"></a>00037     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j;
<a name="l00038"></a>00038     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> b;
<a name="l00039"></a>00039     <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#af27bf2edf7fec2114a773087c13e47bc">h</a>; i++)
<a name="l00040"></a>00040     {
<a name="l00041"></a>00041         <span class="keywordflow">for</span> (j=0; j&lt;<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#ad6c2a2c3c786bf63f7beacf503ff5c45">w</a>; j++)
<a name="l00042"></a>00042         {
<a name="l00043"></a>00043             <span class="keywordflow">for</span>(b=0;b&lt;inbands;b++)
<a name="l00044"></a>00044             { 
<a name="l00045"></a>00045                 memcpy((outbuf+(i+<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#af6a91f603ecbb9cc9bf95e81859a6a4c">y0</a>)*outyStride+(j+<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#a637cf3e6d7adecc8dc547ee83d2d22de">x0</a>)*outxStride+b*writeBytes),
<a name="l00046"></a>00046                     (inbuf+i*inyStride +j*inxStride+b*writeBytes),  writeBytes);
<a name="l00047"></a>00047             }           
<a name="l00048"></a>00048         }
<a name="l00049"></a>00049     }
<a name="l00050"></a>00050 
<a name="l00051"></a>00051     <span class="comment">//fill left </span>
<a name="l00052"></a>00052     <span class="keywordflow">for</span>(i=0;i&lt;outheight;i++)
<a name="l00053"></a>00053     {
<a name="l00054"></a>00054         <span class="keywordflow">for</span>(j=0;j&lt;=<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#a637cf3e6d7adecc8dc547ee83d2d22de">x0</a>;j++)
<a name="l00055"></a>00055         {
<a name="l00056"></a>00056             <span class="keywordflow">for</span>(b=0;b&lt;inbands;b++)
<a name="l00057"></a>00057             {
<a name="l00058"></a>00058                 memcpy( (outbuf + i*outyStride + j*outxStride+b*writeBytes), 
<a name="l00059"></a>00059                     (outbuf + i*outyStride + (2*<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#a637cf3e6d7adecc8dc547ee83d2d22de">x0</a>-j)*outxStride+b*writeBytes),    writeBytes);
<a name="l00060"></a>00060             }
<a name="l00061"></a>00061         }
<a name="l00062"></a>00062     }
<a name="l00063"></a>00063 
<a name="l00064"></a>00064     <span class="comment">//fill right</span>
<a name="l00065"></a>00065     <span class="keywordflow">for</span>(i=0;i&lt;outheight;i++)
<a name="l00066"></a>00066     {
<a name="l00067"></a>00067         <span class="keywordflow">for</span>(j=0;j&lt;(outwidth-<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#a637cf3e6d7adecc8dc547ee83d2d22de">x0</a>-<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#ad6c2a2c3c786bf63f7beacf503ff5c45">w</a>);j++)
<a name="l00068"></a>00068         {
<a name="l00069"></a>00069             <span class="keywordflow">for</span>(b=0;b&lt;inbands;b++)
<a name="l00070"></a>00070             {
<a name="l00071"></a>00071                 memcpy( (outbuf + i*outyStride + (<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#a637cf3e6d7adecc8dc547ee83d2d22de">x0</a>+<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#ad6c2a2c3c786bf63f7beacf503ff5c45">w</a>+j)*outxStride+b*writeBytes),   
<a name="l00072"></a>00072                     (outbuf+i*outyStride+ (<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#a637cf3e6d7adecc8dc547ee83d2d22de">x0</a>+<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#ad6c2a2c3c786bf63f7beacf503ff5c45">w</a>-j-1)*outxStride+b*writeBytes),    writeBytes);
<a name="l00073"></a>00073             }
<a name="l00074"></a>00074         }
<a name="l00075"></a>00075     }
<a name="l00076"></a>00076 
<a name="l00077"></a>00077     <span class="comment">//fill top </span>
<a name="l00078"></a>00078     <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#af6a91f603ecbb9cc9bf95e81859a6a4c">y0</a>;i++)
<a name="l00079"></a>00079     {
<a name="l00080"></a>00080         <span class="keywordflow">for</span>(j=0;j&lt;=outwidth;j++)
<a name="l00081"></a>00081         {
<a name="l00082"></a>00082             <span class="keywordflow">for</span>(b=0;b&lt;inbands;b++)
<a name="l00083"></a>00083             {
<a name="l00084"></a>00084                 memcpy( (outbuf + i*outyStride + j*outxStride+b*writeBytes), 
<a name="l00085"></a>00085                     (outbuf + (2*<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#af6a91f603ecbb9cc9bf95e81859a6a4c">y0</a>-i)*outyStride + (j)*outxStride+b*writeBytes),  writeBytes);
<a name="l00086"></a>00086             }
<a name="l00087"></a>00087         }
<a name="l00088"></a>00088     }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090     <span class="comment">//fill bottom</span>
<a name="l00091"></a>00091     <span class="keywordflow">for</span>(i=0;i&lt;(outheight-<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#af6a91f603ecbb9cc9bf95e81859a6a4c">y0</a>-<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#af27bf2edf7fec2114a773087c13e47bc">h</a> )  ;i++)
<a name="l00092"></a>00092     {
<a name="l00093"></a>00093         <span class="keywordflow">for</span>(j=0;j&lt;outwidth;j++)
<a name="l00094"></a>00094         {
<a name="l00095"></a>00095             <span class="keywordflow">for</span>(b=0;b&lt;inbands;b++)
<a name="l00096"></a>00096             {
<a name="l00097"></a>00097                 memcpy( (outbuf + (<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#af6a91f603ecbb9cc9bf95e81859a6a4c">y0</a>+<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#af27bf2edf7fec2114a773087c13e47bc">h</a>+i )*outyStride + j*outxStride+b*writeBytes), 
<a name="l00098"></a>00098                     (outbuf + (<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#af6a91f603ecbb9cc9bf95e81859a6a4c">y0</a>+<a class="code" href="classkl_pad_functor.html#a603366d855018e6db204e9a660d19271">rect</a>.<a class="code" href="structkl_pad_functor_1_1pad_rect.html#af27bf2edf7fec2114a773087c13e47bc">h</a>-i-1 )*outyStride + (j)*outxStride+b*writeBytes),  writeBytes);
<a name="l00099"></a>00099             }
<a name="l00100"></a>00100         }
<a name="l00101"></a>00101     }
<a name="l00102"></a>00102 }
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="comment">//MT ImageDemo</span>
<a name="l00105"></a>00105 <span class="preprocessor">#include &quot;kl_thread_workflow.h&quot;</span>
<a name="l00106"></a>00106 
<a name="l00107"></a><a class="code" href="kl__image__processing__functors_8cpp.html#a9d7684733c3ca2f1e3d28a22fdc7deac">00107</a> <span class="keywordtype">void</span> <a class="code" href="kl__image__processing__functors_8cpp.html#a9d7684733c3ca2f1e3d28a22fdc7deac">ImageWork</a>(<span class="keywordtype">string</span> fileName,<span class="keywordtype">string</span> outputPath)
<a name="l00108"></a>00108 {
<a name="l00109"></a>00109     <span class="keyword">const</span> <span class="keywordtype">char</span>* infilename=fileName.c_str();
<a name="l00110"></a>00110     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inwidth=0;
<a name="l00111"></a>00111     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inheight=0;
<a name="l00112"></a>00112     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inbands=0;
<a name="l00113"></a>00113     
<a name="l00114"></a>00114     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc;
<a name="l00115"></a>00115     <span class="keywordflow">if</span>( <a class="code" href="kl__ppm__image__io_8cpp.html#a3453a753c60d966d35724298d6118a7c">query_ppm</a> (infilename, inwidth, inheight,inbands))
<a name="l00116"></a>00116     {
<a name="l00117"></a>00117         lsrc=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a>(inwidth,inheight, inbands);
<a name="l00118"></a>00118         <a class="code" href="kl__ppm__image__io_8cpp.html#a4e631bab8c488b3cdb27e6829a66a8a7">read_ppm</a> (infilename, inwidth,inheight, inbands,lsrc-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a0b9e8748d6febe81c5803003a38c9b9a">buffer</a>());
<a name="l00119"></a>00119     }
<a name="l00120"></a>00120     <span class="keywordflow">else</span>
<a name="l00121"></a>00121     {
<a name="l00122"></a>00122         <span class="keywordflow">throw</span> <span class="stringliteral">&quot;Bad input file in void testKLImageFunctors()&quot;</span>;
<a name="l00123"></a>00123     }   
<a name="l00124"></a>00124     {<span class="comment">//Test the smart pointer x64 port went well</span>
<a name="l00125"></a>00125         <span class="keywordtype">size_t</span> width=128;
<a name="l00126"></a>00126         <span class="keywordtype">size_t</span> height=128;
<a name="l00127"></a>00127         <span class="keywordtype">size_t</span> bands = 3;
<a name="l00128"></a>00128         <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_No_boo_boo_pointer=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a>(width,height, bands);
<a name="l00129"></a>00129     }<span class="comment">//YAY!</span>
<a name="l00130"></a>00130     
<a name="l00131"></a>00131     <span class="keywordtype">string</span> output =  outputPath;
<a name="l00132"></a>00132     output.append(<span class="stringliteral">&quot;PCA_input.ppm&quot;</span>);
<a name="l00133"></a>00133     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(output.c_str(), lsrc-&gt;width(), lsrc-&gt;height(),lsrc-&gt;buffer());
<a name="l00134"></a>00134 
<a name="l00135"></a>00135     <a class="code" href="classkl_p_c_a_functor.html">klPCAFunctor</a> pca(lsrc);
<a name="l00136"></a>00136     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> dst =  pca();
<a name="l00137"></a>00137     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst_cptbipca=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (dst-&gt;width(),dst-&gt;height(),3 );
<a name="l00138"></a>00138     <a class="code" href="classkl_copy_split_band_functor.html">klCopySplitBandFunctor&lt;unsigned char&gt;</a> kl_cfpitbipca_u8( dst,  ldst_cptbipca);
<a name="l00139"></a>00139     kl_cfpitbipca_u8();
<a name="l00140"></a>00140     output =  outputPath;
<a name="l00141"></a>00141     output.append(<span class="stringliteral">&quot;PCA_PIXTOBAND.pgm&quot;</span>);
<a name="l00142"></a>00142     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), ldst_cptbipca-&gt;width(), ldst_cptbipca-&gt;height()*3,ldst_cptbipca-&gt;buffer());
<a name="l00143"></a>00143 
<a name="l00144"></a>00144     {
<a name="l00145"></a>00145 
<a name="l00146"></a>00146     <span class="keywordtype">unsigned</span> lkernelWidthDF=3;
<a name="l00147"></a>00147     <span class="keywordtype">unsigned</span> lkernelHeightDF=3;
<a name="l00148"></a>00148     <span class="comment">//Mask values. Only pixels that correspond to nonzero </span>
<a name="l00149"></a>00149     <span class="comment">//mask values are taken into account during operation.</span>
<a name="l00150"></a>00150     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* lkernelDF = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[ lkernelWidthDF * lkernelHeightDF ];
<a name="l00151"></a>00151     lkernelDF[0]=1;lkernelDF[1]=1;lkernelDF[2]=1;
<a name="l00152"></a>00152     lkernelDF[3]=1;lkernelDF[4]=0;lkernelDF[5]=1;
<a name="l00153"></a>00153     lkernelDF[6]=1;lkernelDF[7]=1;lkernelDF[8]=1;
<a name="l00154"></a>00154     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_dilated=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );
<a name="l00155"></a>00155     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcfdf_u8(dst, lsrc_dilated);
<a name="l00156"></a>00156     klcfdf_u8();<span class="comment">//Do the copy</span>
<a name="l00157"></a>00157     <a class="code" href="classkl_dilate_functor.html">klDilateFunctor&lt; unsigned char&gt;</a> kldf_u8( lsrc,  lsrc_dilated,  lkernelDF,  lkernelWidthDF, lkernelHeightDF);
<a name="l00158"></a>00158     kldf_u8();
<a name="l00159"></a>00159     <span class="keyword">delete</span> lkernelDF;
<a name="l00160"></a>00160     output =  outputPath;
<a name="l00161"></a>00161     output.append(<span class="stringliteral">&quot;DILATED_u8_C3R.ppm&quot;</span>);
<a name="l00162"></a>00162     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(output.c_str(), lsrc_dilated-&gt;width(), lsrc_dilated-&gt;height(),lsrc_dilated-&gt;buffer());
<a name="l00163"></a>00163 
<a name="l00164"></a>00164     <a class="code" href="classkl_apply_color_unmixing_basis.html">klApplyColorUnmixingBasis</a> ssb(lsrc_dilated);
<a name="l00165"></a>00165     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> dstssb =  ssb();
<a name="l00166"></a>00166     output =  outputPath;   output.append(<span class="stringliteral">&quot;StainSpaceBasis_u8.ppm&quot;</span>);
<a name="l00167"></a>00167     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(output.c_str(), dstssb-&gt;width(), dstssb-&gt;height(),dstssb-&gt;buffer());
<a name="l00168"></a>00168 
<a name="l00169"></a>00169 
<a name="l00170"></a>00170     <span class="comment">//klHandERatio ssp(dstssb);</span>
<a name="l00171"></a>00171     <a class="code" href="classkl_hand_e_ratio.html">klHandERatio</a> ssp(lsrc_dilated);
<a name="l00172"></a>00172     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> dstssp =  ssp();
<a name="l00173"></a>00173     output =  outputPath;   output.append(<span class="stringliteral">&quot;StainPurity_u8_C3R.pgm&quot;</span>);
<a name="l00174"></a>00174     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), dstssp-&gt;width(), dstssp-&gt;height(),dstssp-&gt;buffer());
<a name="l00175"></a>00175 
<a name="l00176"></a>00176     <span class="keywordtype">double</span> lthresholdHi=196;
<a name="l00177"></a>00177     <span class="keywordtype">double</span> lthresholdLow=56;
<a name="l00178"></a>00178     <span class="keywordtype">bool</span> luseLowThreshold=<span class="keyword">true</span>;
<a name="l00179"></a>00179     <span class="keywordtype">bool</span> luseHighThreshold=<span class="keyword">true</span>;
<a name="l00180"></a>00180     <span class="keywordtype">double</span> lthresholdHiVal=255;
<a name="l00181"></a>00181     <span class="keywordtype">double</span> lthresholdLowVal=0;
<a name="l00182"></a>00182     <span class="keywordtype">bool</span> luseThresholdVals=<span class="keyword">true</span>;
<a name="l00183"></a>00183     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_thresh=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00184"></a>00184     <span class="comment">//Skip Stain Purity </span>
<a name="l00185"></a>00185     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcfth_u8(dstssp, lsrc_thresh);
<a name="l00186"></a>00186     klcfth_u8();
<a name="l00187"></a>00187     <a class="code" href="classkl_threshold_functor.html">klThresholdFunctor&lt;unsigned char&gt;</a> kltf_u8( lsrc_thresh, lthresholdHi, lthresholdLow,luseLowThreshold,luseHighThreshold,lthresholdHiVal,lthresholdLowVal, luseThresholdVals);
<a name="l00188"></a>00188     kltf_u8();
<a name="l00189"></a>00189     output =  outputPath;   output.append(<span class="stringliteral">&quot;THRESHOLDED_u8_C3R.pgm&quot;</span>);
<a name="l00190"></a>00190     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a> (output.c_str(), lsrc_thresh-&gt;width(), lsrc_thresh-&gt;height(),lsrc_thresh-&gt;buffer());
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 
<a name="l00194"></a>00194     <span class="comment">/*const klRasterBufferPointer ldst_cptbissb=new klPackedHeapRasterBuffer&lt;unsigned char&gt; (lsrc-&gt;width(),lsrc-&gt;height(),3 );</span>
<a name="l00195"></a>00195 <span class="comment">    klCopySplitBandFunctor&lt;unsigned char&gt; kl_cfpitbissb_u8( dstssb,  ldst_cptbissb);</span>
<a name="l00196"></a>00196 <span class="comment">    kl_cfpitbissb_u8();</span>
<a name="l00197"></a>00197 <span class="comment">    write_ppm_single_band (&quot;SSB_PIXTOBAND.pgm&quot;, ldst_cptbissb-&gt;width(), ldst_cptbissb-&gt;height()*3,ldst_cptbissb-&gt;buffer());*/</span>
<a name="l00198"></a>00198 
<a name="l00199"></a>00199     <span class="comment">//unsigned lkernelWidthEF=3;</span>
<a name="l00200"></a>00200     <span class="comment">//unsigned lkernelHeightEF=3;</span>
<a name="l00201"></a>00201     <span class="comment">//unsigned char* lkernelEF = new unsigned char[ lkernelWidthEF * lkernelHeightEF ];</span>
<a name="l00202"></a>00202     <span class="comment">//lkernelEF[0]=1;lkernelEF[1]=1;lkernelEF[2]=1;</span>
<a name="l00203"></a>00203     <span class="comment">//lkernelEF[3]=1;lkernelEF[4]=0;lkernelEF[5]=1;</span>
<a name="l00204"></a>00204     <span class="comment">//lkernelEF[6]=1;lkernelEF[7]=1;lkernelEF[8]=1;</span>
<a name="l00205"></a>00205     <span class="comment">//const klRasterBufferPointer lsrc_erroded=new klPackedHeapRasterBuffer&lt;unsigned char&gt; (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );</span>
<a name="l00206"></a>00206     <span class="comment">//klCopyFunctor&lt;unsigned char&gt; klcfef_u8(dstssb, lsrc_erroded);</span>
<a name="l00207"></a>00207     <span class="comment">//klcfef_u8();//Do the copy</span>
<a name="l00208"></a>00208     
<a name="l00209"></a>00209 
<a name="l00210"></a>00210     <span class="comment">//klErodeFunctor&lt; unsigned char&gt; klef_u8( dstssb,  lsrc_erroded,  lkernelEF,  lkernelWidthEF, lkernelHeightEF);</span>
<a name="l00211"></a>00211     <span class="comment">//klef_u8();//Do the errode</span>
<a name="l00212"></a>00212     <span class="comment">//write_ppm(&quot;ERRODED_u8_C3R.ppm&quot;, lsrc_erroded-&gt;width(), lsrc_erroded-&gt;height(),lsrc_erroded-&gt;buffer());</span>
<a name="l00213"></a>00213     <span class="comment">//delete lkernelEF;</span>
<a name="l00214"></a>00214 
<a name="l00215"></a>00215     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_logical_B1=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00216"></a>00216 
<a name="l00217"></a>00217     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcflf_B1_u8(lsrc_thresh, lsrc_logical_B1);
<a name="l00218"></a>00218     klcflf_B1_u8();
<a name="l00219"></a>00219     output =  outputPath;   output.append(<span class="stringliteral">&quot;LOGICAL_IN_B1.pgm&quot;</span>);
<a name="l00220"></a>00220     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), lsrc_logical_B1-&gt;width(), lsrc_logical_B1-&gt;height(),lsrc_logical_B1-&gt;buffer());
<a name="l00221"></a>00221 
<a name="l00222"></a>00222     <span class="keywordtype">unsigned</span> lkernelWidthO=3;
<a name="l00223"></a>00223     <span class="keywordtype">unsigned</span> lkernelHeightO=3;
<a name="l00224"></a>00224     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* lkernelO = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[ lkernelWidthO * lkernelHeightO ];
<a name="l00225"></a>00225     lkernelO[0]=0;lkernelO[1]=1;lkernelO[2]=0;
<a name="l00226"></a>00226     lkernelO[3]=1;lkernelO[4]=1;lkernelO[5]=1;
<a name="l00227"></a>00227     lkernelO[6]=0;lkernelO[7]=1;lkernelO[8]=0;
<a name="l00228"></a>00228     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_opened=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),3 );
<a name="l00229"></a>00229     <a class="code" href="classkl_open_functor.html">klOpenFunctor&lt; unsigned char&gt;</a> klof_u8( lsrc,  lsrc_opened,  lkernelO,  lkernelWidthO, lkernelHeightO);
<a name="l00230"></a>00230     klof_u8();
<a name="l00231"></a>00231     output =  outputPath;   output.append(<span class="stringliteral">&quot;Opened_u8_C3R.ppm&quot;</span>);
<a name="l00232"></a>00232     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(output.c_str(), lsrc_opened-&gt;width(), lsrc_opened-&gt;height(),lsrc_opened-&gt;buffer());
<a name="l00233"></a>00233     <span class="keyword">delete</span> lkernelO;
<a name="l00234"></a>00234 
<a name="l00235"></a>00235     
<a name="l00236"></a>00236     <a class="code" href="classkl_composite_mask.html">klCompositeMask</a> klcm( lsrc, lsrc_thresh ,0.5,0,120,0);
<a name="l00237"></a>00237     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> blended = klcm();
<a name="l00238"></a>00238     output =  outputPath;   output.append(<span class="stringliteral">&quot;WhiteSpaceBlended_u8_C3R.ppm&quot;</span>);
<a name="l00239"></a>00239     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(output.c_str(), blended-&gt;width(), blended-&gt;height(),blended-&gt;buffer());
<a name="l00240"></a>00240 
<a name="l00241"></a>00241     }
<a name="l00242"></a>00242 
<a name="l00243"></a>00243     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a>(inwidth,inheight, inbands);
<a name="l00244"></a>00244     <span class="keywordtype">int</span> lband=-1;
<a name="l00245"></a>00245     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcf_u8(lsrc, ldst);
<a name="l00246"></a>00246     klcf_u8();
<a name="l00247"></a>00247     output =  outputPath;   output.append(<span class="stringliteral">&quot;SRC_u8_C3R.ppm&quot;</span>);
<a name="l00248"></a>00248     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a> (output.c_str(), ldst-&gt;width(), ldst-&gt;height(),ldst-&gt;buffer());
<a name="l00249"></a>00249 
<a name="l00250"></a>00250     <span class="comment">//Test filter functor</span>
<a name="l00251"></a>00251     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lkernelWidth=3;
<a name="l00252"></a>00252     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lkernelHeight=3;
<a name="l00253"></a>00253     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*  lkernel=<span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[ lkernelWidth * lkernelHeight ];
<a name="l00254"></a>00254     lkernel[0]= 0.0113*256;lkernel[1]= 0.0838*256;lkernel[2]= 0.0113*256;
<a name="l00255"></a>00255     lkernel[3]= 0.0838*256;lkernel[4]= 0.0113*256;lkernel[5]= 0.08383*256;
<a name="l00256"></a>00256     lkernel[6]= 0.0113*256;lkernel[7]= 0.0838*256;lkernel[8]= 0.0113*256;
<a name="l00257"></a>00257     <span class="comment">//unsigned char *  lkernel=new unsigned char[ lkernelWidth * lkernelHeight ];</span>
<a name="l00258"></a>00258     <span class="comment">//lkernel[0]= 0;lkernel[1]= 0;lkernel[2]=0;</span>
<a name="l00259"></a>00259     <span class="comment">//lkernel[3]= 0;lkernel[4]= 1;lkernel[5]= 0;</span>
<a name="l00260"></a>00260     <span class="comment">//lkernel[6]= 0;lkernel[7]= 0;lkernel[8]= 0;</span>
<a name="l00261"></a>00261 
<a name="l00262"></a>00262     <a class="code" href="classkl_filter_functor.html">klFilterFunctor&lt;unsigned char&gt;</a> klff_u8(ldst, lkernel,  lkernelWidth, lkernelHeight);
<a name="l00263"></a>00263     klff_u8();
<a name="l00264"></a>00264     <span class="keyword">delete</span> lkernel;
<a name="l00265"></a>00265     output =  outputPath;   output.append(<span class="stringliteral">&quot;FILTERED_u8_C3R.ppm&quot;</span>);
<a name="l00266"></a>00266     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a> (output.c_str(), ldst-&gt;width(), ldst-&gt;height(),ldst-&gt;buffer());
<a name="l00267"></a>00267 
<a name="l00268"></a>00268     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst_color_to_gray=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a>(inwidth,inheight, 1);
<a name="l00269"></a>00269     <a class="code" href="classkl_color_to_gray_functor.html">klColorToGrayFunctor&lt;unsigned char&gt;</a> klctg_u8(lsrc,ldst_color_to_gray);
<a name="l00270"></a>00270     klctg_u8();
<a name="l00271"></a>00271     output =  outputPath;   output.append(<span class="stringliteral">&quot;COLOR_TO_GRAY.pgm&quot;</span>);
<a name="l00272"></a>00272     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a> (output.c_str(), ldst_color_to_gray-&gt;width(), ldst_color_to_gray-&gt;height(),ldst_color_to_gray-&gt;buffer());
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 
<a name="l00276"></a>00276     <span class="comment">//Maps [0,thresholdLow] U [thresholdHigh,MAXVAL(TYPE) ] -----&gt; LowVal , HighVal</span>
<a name="l00277"></a>00277     <span class="keywordtype">double</span> lthresholdHi=240;
<a name="l00278"></a>00278     <span class="keywordtype">double</span> lthresholdLow=32;
<a name="l00279"></a>00279     <span class="keywordtype">bool</span> luseLowThreshold=<span class="keyword">true</span>;
<a name="l00280"></a>00280     <span class="keywordtype">bool</span> luseHighThreshold=<span class="keyword">true</span>;
<a name="l00281"></a>00281     <span class="keywordtype">double</span> lthresholdHiVal=200;
<a name="l00282"></a>00282     <span class="keywordtype">double</span> lthresholdLowVal=40;
<a name="l00283"></a>00283     <span class="keywordtype">bool</span> luseThresholdVals=<span class="keyword">true</span>;
<a name="l00284"></a>00284     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_thresh=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );
<a name="l00285"></a>00285     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcfth_u8(lsrc, lsrc_thresh);
<a name="l00286"></a>00286     klcfth_u8();
<a name="l00287"></a>00287     <a class="code" href="classkl_threshold_functor.html">klThresholdFunctor&lt;unsigned char&gt;</a> kltf_u8( lsrc_thresh, lthresholdHi, lthresholdLow,luseLowThreshold,luseHighThreshold,lthresholdHiVal,lthresholdLowVal, luseThresholdVals);
<a name="l00288"></a>00288     kltf_u8();
<a name="l00289"></a>00289     output =  outputPath;   output.append(<span class="stringliteral">&quot;THRESHOLDED_u8_C3R.ppm&quot;</span>);
<a name="l00290"></a>00290     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a> (output.c_str(), lsrc_thresh-&gt;width(), lsrc_thresh-&gt;height(),lsrc_thresh-&gt;buffer());
<a name="l00291"></a>00291 
<a name="l00292"></a>00292 
<a name="l00294"></a>00294     <span class="comment">//Our morphological structure elelment</span>
<a name="l00295"></a>00295     <span class="keywordtype">unsigned</span> lkernelWidthEF=3;
<a name="l00296"></a>00296     <span class="keywordtype">unsigned</span> lkernelHeightEF=3;
<a name="l00297"></a>00297     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* lkernelEF = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[ lkernelWidthEF * lkernelHeightEF ];
<a name="l00298"></a>00298     lkernelEF[0]=1;lkernelEF[1]=1;lkernelEF[2]=1;
<a name="l00299"></a>00299     lkernelEF[3]=1;lkernelEF[4]=0;lkernelEF[5]=1;
<a name="l00300"></a>00300     lkernelEF[6]=1;lkernelEF[7]=1;lkernelEF[8]=1;
<a name="l00301"></a>00301     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_erroded=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );
<a name="l00302"></a>00302     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcfef_u8(lsrc, lsrc_erroded);
<a name="l00303"></a>00303     klcfef_u8();<span class="comment">//Do the copy</span>
<a name="l00304"></a>00304     <span class="keyword">delete</span> lkernelEF;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306     <a class="code" href="classkl_erode_functor.html">klErodeFunctor&lt; unsigned char&gt;</a> klef_u8( lsrc,  lsrc_erroded,  lkernelEF,  lkernelWidthEF, lkernelHeightEF);
<a name="l00307"></a>00307     klef_u8();<span class="comment">//Do the errode</span>
<a name="l00308"></a>00308     output =  outputPath;   output.append(<span class="stringliteral">&quot;ERRODED_u8_C3R.ppm&quot;</span>);
<a name="l00309"></a>00309     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(output.c_str(), lsrc_erroded-&gt;width(), lsrc_erroded-&gt;height(),lsrc_erroded-&gt;buffer());
<a name="l00310"></a>00310 
<a name="l00311"></a>00311     <span class="keywordtype">unsigned</span> lkernelWidthDF=3;
<a name="l00312"></a>00312     <span class="keywordtype">unsigned</span> lkernelHeightDF=3;
<a name="l00313"></a>00313     <span class="comment">//Mask values. Only pixels that correspond to nonzero </span>
<a name="l00314"></a>00314     <span class="comment">//mask values are taken into account during operation.</span>
<a name="l00315"></a>00315     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* lkernelDF = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[ lkernelWidthDF * lkernelHeightDF ];
<a name="l00316"></a>00316     lkernelDF[0]=1;lkernelDF[1]=1;lkernelDF[2]=1;
<a name="l00317"></a>00317     lkernelDF[3]=1;lkernelDF[4]=0;lkernelDF[5]=1;
<a name="l00318"></a>00318     lkernelDF[6]=1;lkernelDF[7]=1;lkernelDF[8]=1;
<a name="l00319"></a>00319     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_dilated=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );
<a name="l00320"></a>00320     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcfdf_u8(lsrc, lsrc_dilated);
<a name="l00321"></a>00321     klcfdf_u8();<span class="comment">//Do the copy</span>
<a name="l00322"></a>00322     <a class="code" href="classkl_dilate_functor.html">klDilateFunctor&lt; unsigned char&gt;</a> kldf_u8( lsrc,  lsrc_dilated,  lkernelDF,  lkernelWidthDF, lkernelHeightDF);
<a name="l00323"></a>00323     kldf_u8();
<a name="l00324"></a>00324     <span class="keyword">delete</span> lkernelDF;
<a name="l00325"></a>00325     output =  outputPath;output.append(<span class="stringliteral">&quot;DILATED_u8_C3R.ppm&quot;</span>);
<a name="l00326"></a>00326     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(output.c_str(), lsrc_dilated-&gt;width(), lsrc_dilated-&gt;height(),lsrc_dilated-&gt;buffer());
<a name="l00327"></a>00327 
<a name="l00328"></a>00328     
<a name="l00330"></a>00330     <span class="comment">//Let&#39;s write the file out with the ppm writer</span>
<a name="l00331"></a>00331     <span class="keywordtype">double</span> angle=-45;
<a name="l00332"></a>00332     <span class="comment">//int interpolate=IPPI_INTER_CUBIC2P_BSPLINE;</span>
<a name="l00333"></a>00333     <span class="keywordtype">int</span> interpolate=IPPI_INTER_NN;
<a name="l00334"></a>00334     <a class="code" href="classkl_rotate_functor.html">klRotateFunctor&lt;unsigned char&gt;</a> klro_u8(lsrc, angle, interpolate);
<a name="l00335"></a>00335     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> src_rotated =klro_u8();
<a name="l00336"></a>00336     output =  outputPath;   output.append(<span class="stringliteral">&quot;ROTATED_u8_C3R.ppm&quot;</span>);
<a name="l00337"></a>00337     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a> (output.c_str(), src_rotated-&gt;width(), src_rotated-&gt;height(),src_rotated-&gt;buffer());
<a name="l00338"></a>00338 
<a name="l00340"></a>00340     <span class="keywordtype">double</span> xFactor=2;
<a name="l00341"></a>00341     <span class="keywordtype">double</span> yFactor=2;
<a name="l00342"></a>00342     interpolate=IPPI_INTER_CUBIC2P_BSPLINE;
<a name="l00343"></a>00343     <a class="code" href="classkl_resize_functor.html">klResizeFunctor&lt;unsigned char&gt;</a> klrs_u8(lsrc, xFactor, yFactor, interpolate);
<a name="l00344"></a>00344     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> src_resampled =klrs_u8();
<a name="l00345"></a>00345     output =  outputPath;   output.append(<span class="stringliteral">&quot;RESAMPLED_u8_C3R.ppm&quot;</span>);
<a name="l00346"></a>00346     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a> (output.c_str(), src_resampled-&gt;width(), src_resampled-&gt;height(),src_resampled-&gt;buffer());
<a name="l00347"></a>00347 
<a name="l00348"></a>00348 
<a name="l00350"></a>00350     <a class="code" href="classkl_rect.html">klRect</a> iRoi(128,128,256,256);
<a name="l00351"></a>00351     <a class="code" href="classkl_rect.html">klRect</a> oRoi(128,128,256,256);
<a name="l00352"></a>00352     <a class="code" href="classkl_copy_r_o_i_functor.html">klCopyROIFunctor&lt;unsigned char&gt;</a> kl_cf_u8( src_rotated,  src_resampled,  iRoi, oRoi);
<a name="l00353"></a>00353     kl_cf_u8();
<a name="l00354"></a>00354     output =  outputPath;   output.append(<span class="stringliteral">&quot;COPYFUNCTION_DIFF_SIZE_u8_C3R.ppm&quot;</span>);
<a name="l00355"></a>00355     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a> (output.c_str(), src_rotated-&gt;width(), src_rotated-&gt;height(),src_rotated-&gt;buffer());
<a name="l00356"></a>00356 
<a name="l00357"></a>00357     <a class="code" href="classkl_copy_r_o_i_functor.html">klCopyROIFunctor&lt;unsigned char&gt;</a> kl_cf_u8t( lsrc_thresh,  lsrc_dilated,  iRoi, oRoi);
<a name="l00358"></a>00358     kl_cf_u8t();
<a name="l00359"></a>00359     output =  outputPath;   output.append(<span class="stringliteral">&quot;COPYFUNCTION_SAME_SIZE_u8_C3R.ppm&quot;</span>);
<a name="l00360"></a>00360     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a> (output.c_str(), lsrc_thresh-&gt;width(), lsrc_thresh-&gt;height(),lsrc_thresh-&gt;buffer());
<a name="l00361"></a>00361     
<a name="l00363"></a>00363     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst_cptbi=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (src_rotated-&gt;width(),src_rotated-&gt;height(),src_rotated-&gt;numBands() );
<a name="l00364"></a>00364     <a class="code" href="classkl_copy_split_band_functor.html">klCopySplitBandFunctor&lt;unsigned char&gt;</a> kl_cfpitbi_u8( src_rotated,  ldst_cptbi);
<a name="l00365"></a>00365     kl_cfpitbi_u8();
<a name="l00366"></a>00366     output =  outputPath;   output.append(<span class="stringliteral">&quot;COPYFUNCTION_PIXTOBAND_u8_P3R.pgm&quot;</span>);
<a name="l00367"></a>00367     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a> (output.c_str(), ldst_cptbi-&gt;width(), ldst_cptbi-&gt;height()*3,ldst_cptbi-&gt;buffer());
<a name="l00368"></a>00368 
<a name="l00369"></a>00369     <span class="comment">//Test logical functor - and the first and second bands</span>
<a name="l00370"></a>00370     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_logical_B1=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00371"></a>00371     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_logical_B2=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00372"></a>00372     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_logical_B3=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00373"></a>00373 
<a name="l00374"></a>00374     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> logical_result=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00375"></a>00375         
<a name="l00376"></a>00376     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcflf_B1_u8(lsrc, lsrc_logical_B1,0);
<a name="l00377"></a>00377     klcflf_B1_u8();
<a name="l00378"></a>00378     output =  outputPath;   output.append(<span class="stringliteral">&quot;LOGICAL_IN_B1.pgm&quot;</span>);
<a name="l00379"></a>00379     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), lsrc_logical_B1-&gt;width(), lsrc_logical_B1-&gt;height(),lsrc_logical_B1-&gt;buffer());
<a name="l00380"></a>00380     
<a name="l00381"></a>00381     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcflf_B2_u8(lsrc, lsrc_logical_B2,1);
<a name="l00382"></a>00382     klcflf_B2_u8();
<a name="l00383"></a>00383     output =  outputPath;   output.append(<span class="stringliteral">&quot;LOGICAL_IN_B2.pgm&quot;</span>);
<a name="l00384"></a>00384     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), lsrc_logical_B2-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a1c1a57f455690160e825073e3b297c9c">width</a>(), lsrc_logical_B2-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a700315115a5375ef88c78b311139d7d9">height</a>(),lsrc_logical_B2-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a0b9e8748d6febe81c5803003a38c9b9a">buffer</a>());
<a name="l00385"></a>00385 
<a name="l00386"></a>00386     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcflf_B3_u8(lsrc, lsrc_logical_B3,2);
<a name="l00387"></a>00387     klcflf_B3_u8();
<a name="l00388"></a>00388     output =  outputPath;   output.append(<span class="stringliteral">&quot;LOGICAL_IN_B3.pgm&quot;</span>);
<a name="l00389"></a>00389     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), lsrc_logical_B3-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a1c1a57f455690160e825073e3b297c9c">width</a>(), lsrc_logical_B3-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a700315115a5375ef88c78b311139d7d9">height</a>(),lsrc_logical_B3-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a0b9e8748d6febe81c5803003a38c9b9a">buffer</a>());
<a name="l00390"></a>00390 
<a name="l00391"></a>00391     <a class="code" href="classkl_logical_functor.html">klLogicalFunctor</a> klflf_u8(lsrc_logical_B1, lsrc_logical_B2, logical_result,klLogicalFunctor::LogicalFunctorOperationType::AND);
<a name="l00392"></a>00392     klflf_u8();
<a name="l00393"></a>00393     output =  outputPath;output.append(<span class="stringliteral">&quot;LOGICAL_u8_C1R.pgm&quot;</span>);
<a name="l00394"></a>00394     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), logical_result-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a1c1a57f455690160e825073e3b297c9c">width</a>(), logical_result-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a700315115a5375ef88c78b311139d7d9">height</a>(),logical_result-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a0b9e8748d6febe81c5803003a38c9b9a">buffer</a>());
<a name="l00395"></a>00395 
<a name="l00396"></a>00396 
<a name="l00397"></a>00397     <a class="code" href="classkl_fill_holes_functor.html">klFillHolesFunctor&lt;unsigned char&gt;</a> klfhf_NOT_GREEN_u8(lsrc_logical_B2,255,0);
<a name="l00398"></a>00398     klfhf_NOT_GREEN_u8();
<a name="l00399"></a>00399     output =  outputPath;output.append(<span class="stringliteral">&quot;HOLES_FILLED_B2_u8_C1R.pgm&quot;</span>);
<a name="l00400"></a>00400     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), lsrc_logical_B2-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a1c1a57f455690160e825073e3b297c9c">width</a>(), lsrc_logical_B2-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a700315115a5375ef88c78b311139d7d9">height</a>(),lsrc_logical_B2-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a0b9e8748d6febe81c5803003a38c9b9a">buffer</a>());
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 
<a name="l00403"></a>00403     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> lbackgroundcolor=0;
<a name="l00404"></a>00404     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> lforegroundcolor=255;
<a name="l00405"></a>00405     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_holefill=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00406"></a>00406     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcfhf_u8(lsrc, lsrc_holefill,1);<span class="comment">//Do the first band only</span>
<a name="l00407"></a>00407     klcfhf_u8();
<a name="l00408"></a>00408     <a class="code" href="classkl_fill_holes_functor.html">klFillHolesFunctor&lt;unsigned char&gt;</a> klfhf_u8(lsrc_holefill,lbackgroundcolor,lforegroundcolor);
<a name="l00409"></a>00409     klfhf_u8();
<a name="l00410"></a>00410     output =  outputPath;output.append(<span class="stringliteral">&quot;HOLES_FILLED_u8_C1R.pgm&quot;</span>);
<a name="l00411"></a>00411     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), lsrc_holefill-&gt;width(), lsrc_holefill-&gt;height(),lsrc_holefill-&gt;buffer());
<a name="l00412"></a>00412 
<a name="l00413"></a>00413     <span class="comment">//Test type convert functor.</span>
<a name="l00414"></a>00414     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lfloatSrc=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;float&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands());
<a name="l00415"></a>00415     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> linmin=0;
<a name="l00416"></a>00416     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> linmax=255;
<a name="l00417"></a>00417     <span class="keywordtype">float</span> loutmin=0.0f;
<a name="l00418"></a>00418     <span class="keywordtype">float</span> loutmax=1.0f;
<a name="l00419"></a>00419     <a class="code" href="classkl_type_convert_functor.html">klTypeConvertFunctor&lt;unsigned char,float&gt;</a> kltcfn_f_u8( lsrc, lfloatSrc,  <span class="keyword">true</span>,linmin, linmax,loutmin, loutmax);
<a name="l00420"></a>00420     kltcfn_f_u8();
<a name="l00421"></a>00421 
<a name="l00422"></a>00422     <span class="comment">//{</span>
<a name="l00424"></a>00424 <span class="comment"></span>        <span class="comment">//unsigned int lkernelWidthf32=3;</span>
<a name="l00425"></a>00425         <span class="comment">//unsigned int lkernelHeightf32=3;</span>
<a name="l00426"></a>00426         <span class="comment">//float *  lkernelf32=new float [ lkernelWidth * lkernelHeight ];</span>
<a name="l00427"></a>00427         <span class="comment">//lkernel[0]= 0.0113;lkernel[1]= 0.0838;lkernel[2]= 0.0113;</span>
<a name="l00428"></a>00428         <span class="comment">//lkernel[3]= 0.0838;lkernel[4]= 0.0113;lkernel[5]= 0.08383;</span>
<a name="l00429"></a>00429         <span class="comment">//lkernel[6]= 0.0113;lkernel[7]= 0.0838;lkernel[8]= 0.0113;</span>
<a name="l00430"></a>00430 
<a name="l00431"></a>00431         <span class="comment">//klFilterFunctor&lt;float &gt; klff_f32(lfloatSrc, lkernelf32,  lkernelWidthf32, lkernelHeightf32);</span>
<a name="l00432"></a>00432         <span class="comment">//klff_f32();</span>
<a name="l00433"></a>00433         <span class="comment">//delete lkernelf32;</span>
<a name="l00434"></a>00434 
<a name="l00435"></a>00435         <span class="comment">//BBCREVISIT PROBLEM WITH FLOAT MORPH Functors</span>
<a name="l00436"></a>00436 
<a name="l00437"></a>00437         <span class="comment">//const klRasterBufferPointer lsrc_erroded_f32=new klPackedHeapRasterBuffer&lt;float&gt; (lfloatSrc-&gt;width(),lfloatSrc-&gt;height(),lfloatSrc-&gt;numBands() );</span>
<a name="l00438"></a>00438         <span class="comment">//klCopyFunctor&lt;float&gt; klcfef_f32(lfloatSrc, lsrc_erroded_f32);</span>
<a name="l00439"></a>00439         <span class="comment">//klcfef_f32();//Do the copy</span>
<a name="l00440"></a>00440         <span class="comment">//klErodeFunctor&lt; float&gt; klef_f32( lfloatSrc,  lsrc_erroded_f32,  lkernelEF,  lkernelWidthEF, lkernelHeightEF);</span>
<a name="l00441"></a>00441         <span class="comment">//klef_f32();//Do the errode</span>
<a name="l00442"></a>00442 
<a name="l00443"></a>00443         <span class="comment">//const klRasterBufferPointer lsrc_dilatedf32=new klPackedHeapRasterBuffer&lt;float&gt; (lfloatSrc-&gt;width(),lfloatSrc-&gt;height(),lfloatSrc-&gt;numBands() );</span>
<a name="l00444"></a>00444         <span class="comment">//klCopyFunctor&lt;float &gt; klcfdf_f32(lfloatSrc, lsrc_dilatedf32);</span>
<a name="l00445"></a>00445         <span class="comment">//klcfdf_f32();//Do the copy</span>
<a name="l00446"></a>00446         <span class="comment">//klDilateFunctor&lt; float &gt; kldf_f32( lfloatSrc,  lsrc_dilatedf32,  lkernelDF,  lkernelWidthDF, lkernelHeightDF);</span>
<a name="l00447"></a>00447         <span class="comment">//kldf_f32();</span>
<a name="l00448"></a>00448 
<a name="l00449"></a>00449 
<a name="l00450"></a>00450     <span class="comment">//  double angle=-45;</span>
<a name="l00451"></a>00451     <span class="comment">//  //int interpolate=IPPI_INTER_CUBIC2P_BSPLINE;</span>
<a name="l00452"></a>00452     <span class="comment">//  int interpolate=IPPI_INTER_NN;</span>
<a name="l00453"></a>00453     <span class="comment">//  klRotateFunctor&lt;float&gt; klro_f32(lfloatSrc, angle, interpolate);</span>
<a name="l00454"></a>00454     <span class="comment">//  klRasterBufferPointer src_rotatedf32 =klro_f32();</span>
<a name="l00455"></a>00455 
<a name="l00456"></a>00456     <span class="comment">//  double xFactor=2;</span>
<a name="l00457"></a>00457     <span class="comment">//  double yFactor=2;</span>
<a name="l00458"></a>00458     <span class="comment">//  interpolate=IPPI_INTER_CUBIC2P_BSPLINE;</span>
<a name="l00459"></a>00459 
<a name="l00460"></a>00460     <span class="comment">//  klResizeFunctor&lt;float  &gt; klrs_f32(lfloatSrc, xFactor, yFactor, interpolate);</span>
<a name="l00461"></a>00461     <span class="comment">//  klRasterBufferPointer src_resampledf32 =klrs_f32();</span>
<a name="l00462"></a>00462 
<a name="l00463"></a>00463     <span class="comment">//  klRect iRoi(128,128,256,256);</span>
<a name="l00464"></a>00464     <span class="comment">//  klRect oRoi(128,128,256,256);</span>
<a name="l00465"></a>00465 
<a name="l00466"></a>00466     <span class="comment">//  klCopyROIFunctor&lt;float &gt; kl_cf_f32( src_rotatedf32,  src_resampledf32,  iRoi, oRoi);</span>
<a name="l00467"></a>00467     <span class="comment">//  kl_cf_f32();</span>
<a name="l00468"></a>00468     <span class="comment">//}</span>
<a name="l00470"></a>00470 <span class="comment"></span>
<a name="l00471"></a>00471 }
<a name="l00472"></a>00472 
<a name="l00473"></a><a class="code" href="kl__image__processing__functors_8cpp.html#acae920399b3552ee9fe9923a3de61f3b">00473</a> <span class="keywordtype">int</span> <a class="code" href="kl__image__processing__functors_8cpp.html#acae920399b3552ee9fe9923a3de61f3b">LoadImageFiles</a>(<span class="keywordtype">string</span>* files)
<a name="l00474"></a>00474 {
<a name="l00475"></a>00475     <span class="keywordtype">int</span> numImages = 15;
<a name="l00476"></a>00476     <span class="keywordtype">char</span>** fileList = <span class="keyword">new</span> <span class="keywordtype">char</span>*[numImages];
<a name="l00477"></a>00477 fileList[0] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_10240_13312_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00478"></a>00478 fileList[1] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_15360_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00479"></a>00479 fileList[2] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_16384_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00480"></a>00480 fileList[3] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_17408_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00481"></a>00481 fileList[4] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_18432_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00482"></a>00482 fileList[5] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_19456_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00483"></a>00483 fileList[6] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_20480_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00484"></a>00484 fileList[7] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_21504_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00485"></a>00485 fileList[8] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_22528_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00486"></a>00486 fileList[9] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_23552_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00487"></a>00487 fileList[10] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_24576_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00488"></a>00488 fileList[11] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_25600_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00489"></a>00489 fileList[12] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_26624_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00490"></a>00490 fileList[13] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_27648_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00491"></a>00491 fileList[14] = <span class="stringliteral">&quot;D:\\klDll\\TestDll\\MTImageTestData\\1553_11264_28672_1024_1024__SRC_u8_C3R.ppm&quot;</span>;
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 
<a name="l00494"></a>00494 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;numImages;i++)
<a name="l00495"></a>00495 {
<a name="l00496"></a>00496     *(files+i)= fileList[i];
<a name="l00497"></a>00497 }
<a name="l00498"></a>00498 
<a name="l00499"></a>00499     <span class="keywordflow">return</span> numImages;
<a name="l00500"></a>00500 
<a name="l00501"></a>00501 }
<a name="l00502"></a>00502 
<a name="l00503"></a>00503 
<a name="l00504"></a>00504 <span class="keyword">class </span><a class="code" href="classkl_string_arg_thread.html">klStringArgThread</a> :<span class="keyword">public</span>  <a class="code" href="classkl_thread.html">klThread</a>&lt;klMutex&gt;
<a name="l00505"></a>00505 {
<a name="l00506"></a>00506 <span class="keyword">public</span>:
<a name="l00507"></a><a class="code" href="classkl_string_arg_thread.html#aa093b9bd764cf786ab763d1f4900529a">00507</a>     <a class="code" href="classkl_string_arg_thread.html#aa093b9bd764cf786ab763d1f4900529a">klStringArgThread</a>(<span class="keywordtype">void</span> (*pf)(<span class="keywordtype">string</span>,<span class="keywordtype">string</span> ) )
<a name="l00508"></a>00508     {
<a name="l00509"></a>00509         <a class="code" href="classkl_string_arg_thread.html#ad59e0434789175c295f298f6a01ba9bb">fPtr</a>=pf;
<a name="l00510"></a>00510     }
<a name="l00511"></a><a class="code" href="classkl_string_arg_thread.html#a26c8fa1bdfb7594d4bef4163dd48eb32">00511</a>     <span class="keywordtype">void</span> <a class="code" href="classkl_string_arg_thread.html#a26c8fa1bdfb7594d4bef4163dd48eb32">run</a>()
<a name="l00512"></a>00512     {
<a name="l00513"></a>00513         <a class="code" href="classkl_string_arg_thread.html#ad59e0434789175c295f298f6a01ba9bb">fPtr</a>(<a class="code" href="classkl_string_arg_thread.html#afcac55893aa62a29ac86a6964076f2a2">arg</a>,<a class="code" href="classkl_string_arg_thread.html#a9c2227d09c65475a29d9629753436933">outpath</a>);
<a name="l00514"></a>00514     }
<a name="l00515"></a>00515     void (*<a class="code" href="classkl_string_arg_thread.html#ad59e0434789175c295f298f6a01ba9bb">fPtr</a>)(string, string);
<a name="l00516"></a>00516 
<a name="l00517"></a>00517     <span class="keywordtype">string</span> <a class="code" href="classkl_string_arg_thread.html#afcac55893aa62a29ac86a6964076f2a2">arg</a>;
<a name="l00518"></a>00518     <span class="keywordtype">string</span> <a class="code" href="classkl_string_arg_thread.html#a9c2227d09c65475a29d9629753436933">outpath</a>;
<a name="l00519"></a>00519 };
<a name="l00520"></a>00520 
<a name="l00521"></a><a class="code" href="kl__image__processing__functors_8cpp.html#a5cf514a760136e68606681595080ad46">00521</a> <span class="keywordtype">void</span> <a class="code" href="_aperio_file_manager_8cpp.html#a5cf514a760136e68606681595080ad46">klRunImageWorkFlowImage</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* basefilename)
<a name="l00522"></a>00522 {
<a name="l00523"></a>00523     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numFiles = 15;
<a name="l00524"></a>00524     <span class="keywordtype">string</span>* files = <span class="keyword">new</span> <span class="keywordtype">string</span>[15];
<a name="l00525"></a>00525     <span class="keywordtype">int</span> loaded = <a class="code" href="kl__image__processing__functors_8cpp.html#acae920399b3552ee9fe9923a3de61f3b">LoadImageFiles</a>(files);
<a name="l00526"></a>00526 
<a name="l00527"></a>00527     HANDLE   hProcess=GetCurrentProcess ();
<a name="l00528"></a>00528 
<a name="l00529"></a>00529     klThreadId thisThread=<a class="code" href="classkl_thread.html">klThread&lt;klMutex&gt;::getCurrentThreadId</a>();  
<a name="l00530"></a>00530 
<a name="l00531"></a>00531     klThreadWorkflow&lt;int,klSmartPtr&lt;klStringArgThread &gt; &gt; workflow;
<a name="l00532"></a>00532 
<a name="l00533"></a>00533     void (*pf)(string,string) =<a class="code" href="kl__image__processing__functors_8cpp.html#a9d7684733c3ca2f1e3d28a22fdc7deac">ImageWork</a>;
<a name="l00534"></a>00534      
<a name="l00535"></a>00535     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;8;i++)
<a name="l00536"></a>00536     {
<a name="l00537"></a>00537         
<a name="l00538"></a>00538         klSmartPtr&lt;klStringArgThread &gt; element=<span class="keyword">new</span> <a class="code" href="classkl_string_arg_thread.html">klStringArgThread</a>(pf);
<a name="l00539"></a>00539         element-&gt;arg = *(files+i);
<a name="l00540"></a>00540         
<a name="l00541"></a>00541         std::stringstream out;out &lt;&lt; i;
<a name="l00542"></a>00542         <span class="keywordtype">string</span> outpath = out.str();
<a name="l00543"></a>00543         element-&gt;outpath = outpath;
<a name="l00544"></a>00544         workflow.insertWorkElement(i, element);
<a name="l00545"></a>00545     }
<a name="l00546"></a>00546     workflow.doWork();
<a name="l00547"></a>00547     flushall();
<a name="l00548"></a>00548 }
<a name="l00549"></a>00549 
<a name="l00550"></a>00550 
<a name="l00551"></a><a class="code" href="kl__image__processing__functors_8cpp.html#abc62243747ab6a3329260d9658a1530f">00551</a> <span class="preprocessor">#define KL_TIFF</span>
<a name="l00552"></a>00552 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="kl__image__io_8h.html">kl_image_io.h</a>&quot;</span>
<a name="l00553"></a>00553 <span class="preprocessor">#include &quot;<a class="code" href="kl__tiff__image__io_8h.html">kl_tiff_image_io.h</a>&quot;</span>
<a name="l00554"></a>00554 <span class="preprocessor">#include &quot;<a class="code" href="kl__image__io__factory_8h.html">kl_image_io_factory.h</a>&quot;</span>
<a name="l00555"></a>00555 
<a name="l00556"></a><a class="code" href="kl__image__processing__functors_8cpp.html#af9f9682d7221b6e3b2398b0a84bccf73">00556</a> <span class="keywordtype">void</span> <a class="code" href="kl__image__processing__functors_8cpp.html#af9f9682d7221b6e3b2398b0a84bccf73">Dithering</a>(<span class="keywordtype">string</span> fileName,<span class="keywordtype">string</span> outputPath)
<a name="l00557"></a>00557 {   
<a name="l00558"></a>00558     <a class="code" href="classkl_image_file_source.html">klImageFileSource</a>* klifs= <a class="code" href="classkl_image_file_source_factory.html#aa516d1c83f88eeb193ef9e1ecc7bba97">klImageFileSourceFactory::getFileSource</a>(fileName.c_str());
<a name="l00559"></a>00559 
<a name="l00560"></a>00560     <span class="keywordtype">bool</span> ansOK = klifs-&gt;<a class="code" href="classkl_image_file_source.html#ab0ada36f7278604f20c7ba0c2246ac77">queryImage</a>();
<a name="l00561"></a>00561 
<a name="l00562"></a>00562     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> klrbp = klifs-&gt;operator()();
<a name="l00563"></a>00563 
<a name="l00564"></a>00564     <a class="code" href="classkl_t_i_f_f_source_functor.html">klTIFFSourceFunctor</a> kltfs(fileName.c_str());
<a name="l00565"></a>00565     
<a name="l00566"></a>00566     <span class="keywordtype">string</span> outName = fileName;
<a name="l00567"></a>00567     <span class="keywordtype">size_t</span> pos = outName.find(<span class="stringliteral">&quot;.tif&quot;</span>);
<a name="l00568"></a>00568     outName.replace(pos,pos+4,<span class="stringliteral">&quot;&quot;</span>).append(<span class="stringliteral">&quot;_kltfs_input.ppm&quot;</span>);
<a name="l00569"></a>00569 
<a name="l00570"></a>00570     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc  =kltfs();
<a name="l00571"></a>00571 
<a name="l00572"></a>00572     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(outName.c_str() , lsrc-&gt;width(), lsrc-&gt;height(),lsrc-&gt;buffer());
<a name="l00573"></a>00573 
<a name="l00574"></a>00574     <span class="keywordtype">unsigned</span> lkernelWidthDF=3;
<a name="l00575"></a>00575 
<a name="l00576"></a>00576     <span class="keywordtype">unsigned</span> lkernelHeightDF=3;
<a name="l00577"></a>00577     
<a name="l00578"></a>00578     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* lkernelDF = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[ lkernelWidthDF * lkernelHeightDF ];
<a name="l00579"></a>00579     lkernelDF[0]=1;lkernelDF[1]=1;lkernelDF[2]=1;
<a name="l00580"></a>00580     lkernelDF[3]=1;lkernelDF[4]=0;lkernelDF[5]=1;
<a name="l00581"></a>00581     lkernelDF[6]=1;lkernelDF[7]=1;lkernelDF[8]=1;
<a name="l00582"></a>00582 
<a name="l00583"></a>00583     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_dilated=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );
<a name="l00584"></a>00584     <a class="code" href="classkl_dilate_functor.html">klDilateFunctor&lt; unsigned char&gt;</a> kldf_u8( lsrc,  lsrc_dilated,  lkernelDF,  lkernelWidthDF, lkernelHeightDF);
<a name="l00585"></a>00585     kldf_u8();
<a name="l00586"></a>00586     <span class="keyword">delete</span> lkernelDF;
<a name="l00587"></a>00587     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(<span class="stringliteral">&quot;kltfs_DILATED.ppm&quot;</span>, lsrc_dilated-&gt;width(), lsrc_dilated-&gt;height(),lsrc_dilated-&gt;buffer());
<a name="l00588"></a>00588         
<a name="l00589"></a>00589     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst_color_to_gray=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a>(lsrc_dilated-&gt;width(), lsrc_dilated-&gt;height(), 1);
<a name="l00590"></a>00590     <a class="code" href="classkl_color_to_gray_functor.html">klColorToGrayFunctor&lt;unsigned char&gt;</a> klctg_u8(lsrc_dilated,ldst_color_to_gray);
<a name="l00591"></a>00591     klctg_u8();
<a name="l00592"></a>00592     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a> (<span class="stringliteral">&quot;kltfsCOLOR_TO_GRAY.pgm&quot;</span>, ldst_color_to_gray-&gt;width(), ldst_color_to_gray-&gt;height(),ldst_color_to_gray-&gt;buffer());
<a name="l00593"></a>00593     
<a name="l00594"></a>00594     <span class="keywordtype">char</span>* fileNameC = <span class="keyword">new</span> <span class="keywordtype">char</span>[2048];
<a name="l00595"></a>00595     
<a name="l00596"></a>00596       <span class="comment">/*if (AllocConsole())</span>
<a name="l00597"></a>00597 <span class="comment">      {</span>
<a name="l00598"></a>00598 <span class="comment">          freopen(&quot;CONOUT$&quot;, &quot;wt&quot;, stdout);</span>
<a name="l00599"></a>00599 <span class="comment">          SetConsoleTitle(&quot;Debug Console&quot;);</span>
<a name="l00600"></a>00600 <span class="comment">          SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), FOREGROUND_GREEN | FOREGROUND_BLUE | FOREGROUND_RED);</span>
<a name="l00601"></a>00601 <span class="comment">      }*/</span>
<a name="l00602"></a>00602 
<a name="l00603"></a>00603     HWND handle =  GetConsoleWindow();
<a name="l00604"></a>00604     <span class="keywordtype">bool</span> ans =SetStdHandle(STD_OUTPUT_HANDLE, handle);
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 
<a name="l00607"></a>00607     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> Levels =2;Levels&lt;16;Levels+=1)
<a name="l00608"></a>00608     {
<a name="l00609"></a>00609         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> Noise =0;Noise&lt;30;Noise+=5)
<a name="l00610"></a>00610         {
<a name="l00611"></a>00611             klTimer  dt;
<a name="l00612"></a>00612             dt.tic();
<a name="l00613"></a>00613             {
<a name="l00614"></a>00614                 <span class="comment">//Floid-Steinberg error diffusion</span>
<a name="l00615"></a>00615                 IppiDitherType dithertype = IppiDitherType::ippDitherFS;
<a name="l00616"></a>00616 
<a name="l00617"></a>00617                 <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_dither=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );
<a name="l00618"></a>00618                 <a class="code" href="classkl_dithering_functor.html">klDitheringFunctor&lt; unsigned char&gt;</a> kldither_u8( lsrc_dilated,  lsrc_dither, Levels, dithertype,Noise);
<a name="l00619"></a>00619                 kldither_u8();
<a name="l00620"></a>00620                 sprintf(fileNameC,<span class="stringliteral">&quot;3Band_%03dLevels_%03dNoise_Floid-SteinbergErrorDiffusion.tif&quot;</span>,Levels,Noise);
<a name="l00621"></a>00621                 <a class="code" href="classkl_t_i_f_f_sink_functor.html">klTIFFSinkFunctor</a> kltsf(fileNameC,lsrc_dither);
<a name="l00622"></a>00622                 kltsf();
<a name="l00623"></a>00623 
<a name="l00624"></a>00624                 <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst_color_to_gray_dithered=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a>(lsrc_dither-&gt;width(), lsrc_dither-&gt;height(), 1);
<a name="l00625"></a>00625                 <a class="code" href="classkl_dithering_functor.html">klDitheringFunctor&lt; unsigned char&gt;</a> kldither_u8_1Band( ldst_color_to_gray,  ldst_color_to_gray_dithered, Levels, dithertype,Noise);
<a name="l00626"></a>00626                 kldither_u8_1Band();
<a name="l00627"></a>00627                 sprintf(fileNameC,<span class="stringliteral">&quot;1Band_%03dLevels_%03dNoise_Floid-SteinbergErrorDiffusion.tif&quot;</span>,Levels,Noise);
<a name="l00628"></a>00628                 <a class="code" href="classkl_t_i_f_f_sink_functor.html">klTIFFSinkFunctor</a> kltsfsb(fileNameC,ldst_color_to_gray_dithered);
<a name="l00629"></a>00629                 kltsfsb();
<a name="l00630"></a>00630             }
<a name="l00631"></a>00631 
<a name="l00632"></a>00632             { 
<a name="l00633"></a>00633                 <span class="comment">//Stucki error diffusion dithering </span>
<a name="l00634"></a>00634                 IppiDitherType dithertype =  IppiDitherType::ippDitherStucki;
<a name="l00635"></a>00635                 <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_dither=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );
<a name="l00636"></a>00636                 <a class="code" href="classkl_dithering_functor.html">klDitheringFunctor&lt; unsigned char&gt;</a> kldither_u8( lsrc_dilated,  lsrc_dither, Levels, dithertype,Noise);
<a name="l00637"></a>00637                 kldither_u8();
<a name="l00638"></a>00638                 sprintf(fileNameC,<span class="stringliteral">&quot;3Band_%03dLevels_%03dNoise_StuckiErrorDiffusion.tif&quot;</span>,Levels,Noise);
<a name="l00639"></a>00639                 <a class="code" href="classkl_t_i_f_f_sink_functor.html">klTIFFSinkFunctor</a> kltsf(fileNameC,lsrc_dither);
<a name="l00640"></a>00640                 kltsf();
<a name="l00641"></a>00641                 <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst_color_to_gray_dithered=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a>(lsrc_dither-&gt;width(), lsrc_dither-&gt;height(), 1);
<a name="l00642"></a>00642                 <a class="code" href="classkl_dithering_functor.html">klDitheringFunctor&lt; unsigned char&gt;</a> kldither_u8_1Band( ldst_color_to_gray,  ldst_color_to_gray_dithered, Levels, dithertype,Noise);
<a name="l00643"></a>00643                 kldither_u8_1Band();
<a name="l00644"></a>00644                 sprintf(fileNameC,<span class="stringliteral">&quot;1Band_%03dLevels_%03dNoise_StuckiErrorDiffusion.tif&quot;</span>,Levels,Noise);
<a name="l00645"></a>00645                 <a class="code" href="classkl_t_i_f_f_sink_functor.html">klTIFFSinkFunctor</a> kltsfsb(fileNameC,ldst_color_to_gray_dithered);
<a name="l00646"></a>00646                 kltsfsb();
<a name="l00647"></a>00647             }
<a name="l00648"></a>00648 
<a name="l00649"></a>00649 
<a name="l00650"></a>00650             {
<a name="l00651"></a>00651                 <span class="comment">//Jarvice-Judice-Ninke error diffusion dithering    </span>
<a name="l00652"></a>00652                 IppiDitherType dithertype =  IppiDitherType::ippDitherJJN ;     
<a name="l00653"></a>00653                 <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_dither=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );
<a name="l00654"></a>00654                 <a class="code" href="classkl_dithering_functor.html">klDitheringFunctor&lt; unsigned char&gt;</a> kldither_u8( lsrc_dilated,  lsrc_dither, Levels, dithertype,Noise);
<a name="l00655"></a>00655                 kldither_u8();
<a name="l00656"></a>00656                 sprintf(fileNameC,<span class="stringliteral">&quot;3Band_%03dLevels_%03dNoise_Jarvice-Judice-NinkeiErrorDiffusion.tif&quot;</span>,Levels,Noise);
<a name="l00657"></a>00657                 <a class="code" href="classkl_t_i_f_f_sink_functor.html">klTIFFSinkFunctor</a> kltsf(fileNameC,lsrc_dither);
<a name="l00658"></a>00658                 kltsf();
<a name="l00659"></a>00659                 
<a name="l00660"></a>00660                 <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst_color_to_gray_dithered=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a>(lsrc_dither-&gt;width(), lsrc_dither-&gt;height(), 1);
<a name="l00661"></a>00661                 <a class="code" href="classkl_dithering_functor.html">klDitheringFunctor&lt; unsigned char&gt;</a> kldither_u8_1Band( ldst_color_to_gray,  ldst_color_to_gray_dithered, Levels, dithertype,Noise);
<a name="l00662"></a>00662                 kldither_u8_1Band();
<a name="l00663"></a>00663                 sprintf(fileNameC,<span class="stringliteral">&quot;1Band_%03dLevels_%03dNoise_Jarvice-Judice-NinkeErrorDiffusion.tif&quot;</span>,Levels,Noise);
<a name="l00664"></a>00664                 <a class="code" href="classkl_t_i_f_f_sink_functor.html">klTIFFSinkFunctor</a> kltsfsb(fileNameC,ldst_color_to_gray_dithered);
<a name="l00665"></a>00665                 kltsfsb();
<a name="l00666"></a>00666             }
<a name="l00667"></a>00667 
<a name="l00668"></a>00668             {
<a name="l00669"></a>00669                 <span class="comment">//Bayers threshold dithering  BayerThreshold</span>
<a name="l00670"></a>00670                 IppiDitherType dithertype =  IppiDitherType::ippDitherBayer;    
<a name="l00671"></a>00671                 <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_dither=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );
<a name="l00672"></a>00672                 <a class="code" href="classkl_dithering_functor.html">klDitheringFunctor&lt; unsigned char&gt;</a> kldither_u8( lsrc_dilated,  lsrc_dither, Levels, dithertype,Noise);
<a name="l00673"></a>00673                 kldither_u8();
<a name="l00674"></a>00674                 sprintf(fileNameC,<span class="stringliteral">&quot;3Band_%03dLevels_%03dNoise_BayerThreshold.tif&quot;</span>,Levels,Noise);
<a name="l00675"></a>00675                 <a class="code" href="classkl_t_i_f_f_sink_functor.html">klTIFFSinkFunctor</a> kltsf(fileNameC,lsrc_dither);
<a name="l00676"></a>00676                 kltsf();
<a name="l00677"></a>00677                 
<a name="l00678"></a>00678                 <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst_color_to_gray_dithered=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a>(lsrc_dither-&gt;width(), lsrc_dither-&gt;height(), 1);
<a name="l00679"></a>00679                 <a class="code" href="classkl_dithering_functor.html">klDitheringFunctor&lt; unsigned char&gt;</a> kldither_u8_1Band( ldst_color_to_gray,  ldst_color_to_gray_dithered, Levels, dithertype,Noise);
<a name="l00680"></a>00680                 kldither_u8_1Band();
<a name="l00681"></a>00681                 sprintf(fileNameC,<span class="stringliteral">&quot;1Band_%03dLevels_%03dNoise_BayerThreshold.tif&quot;</span>,Levels,Noise);
<a name="l00682"></a>00682                 <a class="code" href="classkl_t_i_f_f_sink_functor.html">klTIFFSinkFunctor</a> kltsfsb(fileNameC,ldst_color_to_gray_dithered);
<a name="l00683"></a>00683                 kltsfsb();
<a name="l00684"></a>00684             }
<a name="l00685"></a>00685             
<a name="l00686"></a>00686             cout&lt;&lt;<span class="stringliteral">&quot;TicToc = &quot;</span> &lt;&lt;dt.toc()&lt;&lt;endl;
<a name="l00687"></a>00687             printf(<span class="stringliteral">&quot;TicToc = %f\n&quot;</span>,dt.toc());
<a name="l00688"></a>00688         }
<a name="l00689"></a>00689         
<a name="l00690"></a>00690     }
<a name="l00691"></a>00691     <span class="keyword">delete</span> fileNameC;
<a name="l00692"></a>00692 
<a name="l00693"></a>00693     
<a name="l00694"></a>00694 }
<a name="l00695"></a>00695 
<a name="l00696"></a><a class="code" href="kl__image__processing__functors_8cpp.html#a584e604af9487eb59e887e23f1c6a34e">00696</a> <span class="keywordtype">void</span> <a class="code" href="_aperio_file_manager_8cpp.html#a584e604af9487eb59e887e23f1c6a34e">TissueAnalysis</a>(<span class="keywordtype">string</span> fileName,<span class="keywordtype">string</span> outputPath)
<a name="l00697"></a>00697 {
<a name="l00698"></a>00698     <span class="keyword">const</span> <span class="keywordtype">char</span>* infilename=fileName.c_str();
<a name="l00699"></a>00699     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inwidth=0;
<a name="l00700"></a>00700     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inheight=0;
<a name="l00701"></a>00701     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inbands=0;
<a name="l00702"></a>00702 
<a name="l00703"></a>00703     <span class="keywordtype">string</span> output =  outputPath;
<a name="l00704"></a>00704     
<a name="l00705"></a>00705     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc;
<a name="l00706"></a>00706     <span class="keywordflow">if</span>( <a class="code" href="kl__ppm__image__io_8cpp.html#a3453a753c60d966d35724298d6118a7c">query_ppm</a> (infilename, inwidth, inheight,inbands))
<a name="l00707"></a>00707     {
<a name="l00708"></a>00708         lsrc=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a>(inwidth,inheight, inbands);
<a name="l00709"></a>00709         <a class="code" href="kl__ppm__image__io_8cpp.html#a4e631bab8c488b3cdb27e6829a66a8a7">read_ppm</a> (infilename, inwidth,inheight, inbands,lsrc-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a0b9e8748d6febe81c5803003a38c9b9a">buffer</a>());
<a name="l00710"></a>00710     }
<a name="l00711"></a>00711     <span class="keywordflow">else</span>
<a name="l00712"></a>00712     {
<a name="l00713"></a>00713         <span class="keywordflow">throw</span> <span class="stringliteral">&quot;Bad input file in void testKLImageFunctors()&quot;</span>;
<a name="l00714"></a>00714     }   
<a name="l00715"></a>00715     
<a name="l00716"></a>00716     <a class="code" href="classkl_p_c_a_functor.html">klPCAFunctor</a> pca(lsrc);
<a name="l00717"></a>00717     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> dst =  lsrc;
<a name="l00718"></a>00718     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst_cptbipca=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (dst-&gt;width(),dst-&gt;height(),3 );
<a name="l00719"></a>00719     <a class="code" href="classkl_copy_split_band_functor.html">klCopySplitBandFunctor&lt;unsigned char&gt;</a> kl_cfpitbipca_u8( dst,  ldst_cptbipca);
<a name="l00720"></a>00720     kl_cfpitbipca_u8();
<a name="l00721"></a>00721     output =  outputPath;
<a name="l00722"></a>00722     output.append(<span class="stringliteral">&quot;PCA_PIXTOBAND.pgm&quot;</span>);
<a name="l00723"></a>00723     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), ldst_cptbipca-&gt;width(), ldst_cptbipca-&gt;height()*3,ldst_cptbipca-&gt;buffer());
<a name="l00724"></a>00724 
<a name="l00725"></a>00725     {
<a name="l00726"></a>00726 
<a name="l00727"></a>00727     <span class="keywordtype">unsigned</span> lkernelWidthDF=3;
<a name="l00728"></a>00728     <span class="keywordtype">unsigned</span> lkernelHeightDF=3;
<a name="l00729"></a>00729     <span class="comment">//Mask values. Only pixels that correspond to nonzero </span>
<a name="l00730"></a>00730     <span class="comment">//mask values are taken into account during operation.</span>
<a name="l00731"></a>00731     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* lkernelDF = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[ lkernelWidthDF * lkernelHeightDF ];
<a name="l00732"></a>00732     lkernelDF[0]=1;lkernelDF[1]=1;lkernelDF[2]=1;
<a name="l00733"></a>00733     lkernelDF[3]=1;lkernelDF[4]=0;lkernelDF[5]=1;
<a name="l00734"></a>00734     lkernelDF[6]=1;lkernelDF[7]=1;lkernelDF[8]=1;
<a name="l00735"></a>00735     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_dilated=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );
<a name="l00736"></a>00736     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcfdf_u8(dst, lsrc_dilated);
<a name="l00737"></a>00737     klcfdf_u8();<span class="comment">//Do the copy</span>
<a name="l00738"></a>00738     <a class="code" href="classkl_dilate_functor.html">klDilateFunctor&lt; unsigned char&gt;</a> kldf_u8( lsrc,  lsrc_dilated,  lkernelDF,  lkernelWidthDF, lkernelHeightDF);
<a name="l00739"></a>00739     kldf_u8();
<a name="l00740"></a>00740     <span class="keyword">delete</span> lkernelDF;
<a name="l00741"></a>00741     output =  outputPath;
<a name="l00742"></a>00742     output.append(<span class="stringliteral">&quot;DILATED_u8_C3R.ppm&quot;</span>);
<a name="l00743"></a>00743     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(output.c_str(), lsrc_dilated-&gt;width(), lsrc_dilated-&gt;height(),lsrc_dilated-&gt;buffer());
<a name="l00744"></a>00744 
<a name="l00745"></a>00745     <a class="code" href="classkl_apply_color_unmixing_basis.html">klApplyColorUnmixingBasis</a> ssb(lsrc_dilated);
<a name="l00746"></a>00746     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> dstssb =  ssb();
<a name="l00747"></a>00747     output =  outputPath; output.append(<span class="stringliteral">&quot;SSB_PIXTOBAND.pgm&quot;</span>);
<a name="l00748"></a>00748     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), ldst_cptbipca-&gt;width(), ldst_cptbipca-&gt;height()*3,ldst_cptbipca-&gt;buffer());
<a name="l00749"></a>00749     output =  outputPath; output.append(<span class="stringliteral">&quot;SSB.ppm&quot;</span>);
<a name="l00750"></a>00750     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(output.c_str(), dstssb-&gt;width(), dstssb-&gt;height(),dstssb-&gt;buffer());
<a name="l00751"></a>00751 
<a name="l00752"></a>00752     output =  outputPath; output.append(<span class="stringliteral">&quot;SSB_2.pgm&quot;</span>);
<a name="l00753"></a>00753     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), dstssb-&gt;width(), dstssb-&gt;height()*3,dstssb-&gt;buffer());
<a name="l00754"></a>00754 
<a name="l00755"></a>00755 
<a name="l00756"></a>00756     <span class="comment">//klHandERatio ssp(dstssb);</span>
<a name="l00757"></a>00757     <a class="code" href="classkl_hand_e_ratio.html">klHandERatio</a> ssp(lsrc_dilated);
<a name="l00758"></a>00758     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> dstssp =  ssp();
<a name="l00759"></a>00759     output =  outputPath;   output.append(<span class="stringliteral">&quot;StainPurity_u8_C3R.pgm&quot;</span>);
<a name="l00760"></a>00760     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), dstssp-&gt;width(), dstssp-&gt;height(),dstssp-&gt;buffer());
<a name="l00761"></a>00761 
<a name="l00762"></a>00762     <span class="keywordtype">double</span> lthresholdHi=196;
<a name="l00763"></a>00763     <span class="keywordtype">double</span> lthresholdLow=56;
<a name="l00764"></a>00764     <span class="keywordtype">bool</span> luseLowThreshold=<span class="keyword">true</span>;
<a name="l00765"></a>00765     <span class="keywordtype">bool</span> luseHighThreshold=<span class="keyword">true</span>;
<a name="l00766"></a>00766     <span class="keywordtype">double</span> lthresholdHiVal=255;
<a name="l00767"></a>00767     <span class="keywordtype">double</span> lthresholdLowVal=0;
<a name="l00768"></a>00768     <span class="keywordtype">bool</span> luseThresholdVals=<span class="keyword">true</span>;
<a name="l00769"></a>00769     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_thresh=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00770"></a>00770     <span class="comment">//Skip Stain Purity </span>
<a name="l00771"></a>00771     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcfth_u8(dstssp, lsrc_thresh);
<a name="l00772"></a>00772     klcfth_u8();
<a name="l00773"></a>00773     <a class="code" href="classkl_threshold_functor.html">klThresholdFunctor&lt;unsigned char&gt;</a> kltf_u8( lsrc_thresh, lthresholdHi, lthresholdLow,luseLowThreshold,luseHighThreshold,lthresholdHiVal,lthresholdLowVal, luseThresholdVals);
<a name="l00774"></a>00774     kltf_u8();
<a name="l00775"></a>00775     output =  outputPath;   output.append(<span class="stringliteral">&quot;THRESHOLDED_u8_C3R.pgm&quot;</span>);
<a name="l00776"></a>00776     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a> (output.c_str(), lsrc_thresh-&gt;width(), lsrc_thresh-&gt;height(),lsrc_thresh-&gt;buffer());
<a name="l00777"></a>00777 
<a name="l00778"></a>00778     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst_cptbissb=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),3 );
<a name="l00779"></a>00779     <a class="code" href="classkl_copy_split_band_functor.html">klCopySplitBandFunctor&lt;unsigned char&gt;</a> kl_cfpitbissb_u8( lsrc_dilated,  ldst_cptbissb);
<a name="l00780"></a>00780     kl_cfpitbissb_u8();
<a name="l00781"></a>00781     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a> (<span class="stringliteral">&quot;SplitBandFuntor_SSB_PIXTOBAND.pgm&quot;</span>, ldst_cptbissb-&gt;width(), ldst_cptbissb-&gt;height()*3,ldst_cptbissb-&gt;buffer());
<a name="l00782"></a>00782 
<a name="l00783"></a>00783     <span class="comment">//unsigned lkernelWidthEF=3;</span>
<a name="l00784"></a>00784     <span class="comment">//unsigned lkernelHeightEF=3;</span>
<a name="l00785"></a>00785     <span class="comment">//unsigned char* lkernelEF = new unsigned char[ lkernelWidthEF * lkernelHeightEF ];</span>
<a name="l00786"></a>00786     <span class="comment">//lkernelEF[0]=1;lkernelEF[1]=1;lkernelEF[2]=1;</span>
<a name="l00787"></a>00787     <span class="comment">//lkernelEF[3]=1;lkernelEF[4]=0;lkernelEF[5]=1;</span>
<a name="l00788"></a>00788     <span class="comment">//lkernelEF[6]=1;lkernelEF[7]=1;lkernelEF[8]=1;</span>
<a name="l00789"></a>00789     <span class="comment">//const klRasterBufferPointer lsrc_erroded=new klPackedHeapRasterBuffer&lt;unsigned char&gt; (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );</span>
<a name="l00790"></a>00790     <span class="comment">//klCopyFunctor&lt;unsigned char&gt; klcfef_u8(dstssb, lsrc_erroded);</span>
<a name="l00791"></a>00791     <span class="comment">//klcfef_u8();//Do the copy</span>
<a name="l00792"></a>00792     
<a name="l00793"></a>00793 
<a name="l00794"></a>00794     <span class="comment">//klErodeFunctor&lt; unsigned char&gt; klef_u8( dstssb,  lsrc_erroded,  lkernelEF,  lkernelWidthEF, lkernelHeightEF);</span>
<a name="l00795"></a>00795     <span class="comment">//klef_u8();//Do the errode</span>
<a name="l00796"></a>00796     <span class="comment">//write_ppm(&quot;ERRODED_u8_C3R.ppm&quot;, lsrc_erroded-&gt;width(), lsrc_erroded-&gt;height(),lsrc_erroded-&gt;buffer());</span>
<a name="l00797"></a>00797     <span class="comment">//delete lkernelEF;</span>
<a name="l00798"></a>00798 
<a name="l00799"></a>00799     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_logical_B1=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00800"></a>00800 
<a name="l00801"></a>00801     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcflf_B1_u8(lsrc_thresh, lsrc_logical_B1);
<a name="l00802"></a>00802     klcflf_B1_u8();
<a name="l00803"></a>00803     output =  outputPath;   output.append(<span class="stringliteral">&quot;LOGICAL_IN_B1.pgm&quot;</span>);
<a name="l00804"></a>00804     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), lsrc_logical_B1-&gt;width(), lsrc_logical_B1-&gt;height(),lsrc_logical_B1-&gt;buffer());
<a name="l00805"></a>00805 
<a name="l00806"></a>00806     <span class="keywordtype">unsigned</span> lkernelWidthO=3;
<a name="l00807"></a>00807     <span class="keywordtype">unsigned</span> lkernelHeightO=3;
<a name="l00808"></a>00808     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* lkernelO = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[ lkernelWidthO * lkernelHeightO ];
<a name="l00809"></a>00809     lkernelO[0]=0;lkernelO[1]=1;lkernelO[2]=0;
<a name="l00810"></a>00810     lkernelO[3]=1;lkernelO[4]=1;lkernelO[5]=1;
<a name="l00811"></a>00811     lkernelO[6]=0;lkernelO[7]=1;lkernelO[8]=0;
<a name="l00812"></a>00812     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_opened=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),3 );
<a name="l00813"></a>00813     <a class="code" href="classkl_open_functor.html">klOpenFunctor&lt; unsigned char&gt;</a> klof_u8( lsrc,  lsrc_opened,  lkernelO,  lkernelWidthO, lkernelHeightO);
<a name="l00814"></a>00814     klof_u8();
<a name="l00815"></a>00815     output =  outputPath;   output.append(<span class="stringliteral">&quot;Opened_u8_C3R.ppm&quot;</span>);
<a name="l00816"></a>00816     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(output.c_str(), lsrc_opened-&gt;width(), lsrc_opened-&gt;height(),lsrc_opened-&gt;buffer());
<a name="l00817"></a>00817     <span class="keyword">delete</span> lkernelO;
<a name="l00818"></a>00818     
<a name="l00819"></a>00819     <a class="code" href="classkl_composite_mask.html">klCompositeMask</a> klcm( lsrc, lsrc_thresh ,0.5,0,120,0);
<a name="l00820"></a>00820     <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> blended = klcm();
<a name="l00821"></a>00821     output =  outputPath;   output.append(<span class="stringliteral">&quot;WhiteSpaceBlended_u8_C3R.ppm&quot;</span>);
<a name="l00822"></a>00822     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(output.c_str(), blended-&gt;width(), blended-&gt;height(),blended-&gt;buffer());
<a name="l00823"></a>00823 
<a name="l00824"></a>00824     }
<a name="l00825"></a>00825 
<a name="l00826"></a>00826     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a>(inwidth,inheight, inbands);
<a name="l00827"></a>00827     <span class="keywordtype">int</span> lband=-1;
<a name="l00828"></a>00828     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcf_u8(lsrc, ldst);
<a name="l00829"></a>00829     klcf_u8();
<a name="l00830"></a>00830     output =  outputPath;   output.append(<span class="stringliteral">&quot;SRC_u8_C3R.ppm&quot;</span>);
<a name="l00831"></a>00831     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a> (output.c_str(), ldst-&gt;width(), ldst-&gt;height(),ldst-&gt;buffer());
<a name="l00832"></a>00832 
<a name="l00833"></a>00833     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lkernelWidth=3;
<a name="l00834"></a>00834     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lkernelHeight=3;
<a name="l00835"></a>00835     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*  lkernel=<span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[ lkernelWidth * lkernelHeight ];
<a name="l00836"></a>00836     lkernel[0]= 0.0113*256;lkernel[1]= 0.0838*256;lkernel[2]= 0.0113*256;
<a name="l00837"></a>00837     lkernel[3]= 0.0838*256;lkernel[4]= 0.0113*256;lkernel[5]= 0.08383*256;
<a name="l00838"></a>00838     lkernel[6]= 0.0113*256;lkernel[7]= 0.0838*256;lkernel[8]= 0.0113*256;
<a name="l00839"></a>00839 
<a name="l00840"></a>00840     <a class="code" href="classkl_filter_functor.html">klFilterFunctor&lt;unsigned char&gt;</a> klff_u8(ldst, lkernel,  lkernelWidth, lkernelHeight);
<a name="l00841"></a>00841     klff_u8();
<a name="l00842"></a>00842     <span class="keyword">delete</span> lkernel;
<a name="l00843"></a>00843     output =  outputPath;   output.append(<span class="stringliteral">&quot;FILTERED_u8_C3R.ppm&quot;</span>);
<a name="l00844"></a>00844     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a> (output.c_str(), ldst-&gt;width(), ldst-&gt;height(),ldst-&gt;buffer());
<a name="l00845"></a>00845 
<a name="l00846"></a>00846     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst_color_to_gray=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a>(inwidth,inheight, 1);
<a name="l00847"></a>00847     <a class="code" href="classkl_color_to_gray_functor.html">klColorToGrayFunctor&lt;unsigned char&gt;</a> klctg_u8(lsrc,ldst_color_to_gray);
<a name="l00848"></a>00848     klctg_u8();
<a name="l00849"></a>00849     output =  outputPath;   output.append(<span class="stringliteral">&quot;COLOR_TO_GRAY.pgm&quot;</span>);
<a name="l00850"></a>00850     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a> (output.c_str(), ldst_color_to_gray-&gt;width(), ldst_color_to_gray-&gt;height(),ldst_color_to_gray-&gt;buffer());
<a name="l00851"></a>00851 
<a name="l00852"></a>00852     <span class="comment">//Maps [0,thresholdLow] U [thresholdHigh,MAXVAL(TYPE) ] -----&gt; LowVal , HighVal</span>
<a name="l00853"></a>00853     <span class="keywordtype">double</span> lthresholdHi=240;
<a name="l00854"></a>00854     <span class="keywordtype">double</span> lthresholdLow=32;
<a name="l00855"></a>00855     <span class="keywordtype">bool</span> luseLowThreshold=<span class="keyword">true</span>;
<a name="l00856"></a>00856     <span class="keywordtype">bool</span> luseHighThreshold=<span class="keyword">true</span>;
<a name="l00857"></a>00857     <span class="keywordtype">double</span> lthresholdHiVal=200;
<a name="l00858"></a>00858     <span class="keywordtype">double</span> lthresholdLowVal=40;
<a name="l00859"></a>00859     <span class="keywordtype">bool</span> luseThresholdVals=<span class="keyword">true</span>;
<a name="l00860"></a>00860     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_thresh=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );
<a name="l00861"></a>00861     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcfth_u8(lsrc, lsrc_thresh);
<a name="l00862"></a>00862     klcfth_u8();
<a name="l00863"></a>00863     <a class="code" href="classkl_threshold_functor.html">klThresholdFunctor&lt;unsigned char&gt;</a> kltf_u8( lsrc_thresh, lthresholdHi, lthresholdLow,luseLowThreshold,luseHighThreshold,lthresholdHiVal,lthresholdLowVal, luseThresholdVals);
<a name="l00864"></a>00864     kltf_u8();
<a name="l00865"></a>00865     output =  outputPath;   output.append(<span class="stringliteral">&quot;THRESHOLDED_u8_C3R.ppm&quot;</span>);
<a name="l00866"></a>00866     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a> (output.c_str(), lsrc_thresh-&gt;width(), lsrc_thresh-&gt;height(),lsrc_thresh-&gt;buffer());
<a name="l00867"></a>00867 
<a name="l00868"></a>00868     <span class="comment">//Our morphological structure elelment</span>
<a name="l00869"></a>00869     <span class="keywordtype">unsigned</span> lkernelWidthEF=3;
<a name="l00870"></a>00870     <span class="keywordtype">unsigned</span> lkernelHeightEF=3;
<a name="l00871"></a>00871     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* lkernelEF = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[ lkernelWidthEF * lkernelHeightEF ];
<a name="l00872"></a>00872     lkernelEF[0]=1;lkernelEF[1]=1;lkernelEF[2]=1;
<a name="l00873"></a>00873     lkernelEF[3]=1;lkernelEF[4]=0;lkernelEF[5]=1;
<a name="l00874"></a>00874     lkernelEF[6]=1;lkernelEF[7]=1;lkernelEF[8]=1;
<a name="l00875"></a>00875     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_erroded=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );
<a name="l00876"></a>00876     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcfef_u8(lsrc, lsrc_erroded);
<a name="l00877"></a>00877     klcfef_u8();<span class="comment">//Do the copy</span>
<a name="l00878"></a>00878     <span class="keyword">delete</span> lkernelEF;
<a name="l00879"></a>00879 
<a name="l00880"></a>00880     <a class="code" href="classkl_erode_functor.html">klErodeFunctor&lt; unsigned char&gt;</a> klef_u8( lsrc,  lsrc_erroded,  lkernelEF,  lkernelWidthEF, lkernelHeightEF);
<a name="l00881"></a>00881     klef_u8();<span class="comment">//Do the errode</span>
<a name="l00882"></a>00882     output =  outputPath;   output.append(<span class="stringliteral">&quot;ERRODED_u8_C3R.ppm&quot;</span>);
<a name="l00883"></a>00883     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(output.c_str(), lsrc_erroded-&gt;width(), lsrc_erroded-&gt;height(),lsrc_erroded-&gt;buffer());
<a name="l00884"></a>00884 
<a name="l00885"></a>00885     <span class="keywordtype">unsigned</span> lkernelWidthDF=3;
<a name="l00886"></a>00886     <span class="keywordtype">unsigned</span> lkernelHeightDF=3;
<a name="l00887"></a>00887     <span class="comment">//Mask values. Only pixels that correspond to nonzero </span>
<a name="l00888"></a>00888     <span class="comment">//mask values are taken into account during operation.</span>
<a name="l00889"></a>00889     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* lkernelDF = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[ lkernelWidthDF * lkernelHeightDF ];
<a name="l00890"></a>00890     lkernelDF[0]=1;lkernelDF[1]=1;lkernelDF[2]=1;
<a name="l00891"></a>00891     lkernelDF[3]=1;lkernelDF[4]=0;lkernelDF[5]=1;
<a name="l00892"></a>00892     lkernelDF[6]=1;lkernelDF[7]=1;lkernelDF[8]=1;
<a name="l00893"></a>00893     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_dilated=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),lsrc-&gt;numBands() );
<a name="l00894"></a>00894     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcfdf_u8(lsrc, lsrc_dilated);
<a name="l00895"></a>00895     klcfdf_u8();<span class="comment">//Do the copy</span>
<a name="l00896"></a>00896     <a class="code" href="classkl_dilate_functor.html">klDilateFunctor&lt; unsigned char&gt;</a> kldf_u8( lsrc,  lsrc_dilated,  lkernelDF,  lkernelWidthDF, lkernelHeightDF);
<a name="l00897"></a>00897     kldf_u8();
<a name="l00898"></a>00898     <span class="keyword">delete</span> lkernelDF;
<a name="l00899"></a>00899     output =  outputPath;output.append(<span class="stringliteral">&quot;DILATED_u8_C3R.ppm&quot;</span>);
<a name="l00900"></a>00900     <a class="code" href="kl__ppm__image__io_8cpp.html#abd4e33d1b3a2a25e1a64f8a52a101150">write_ppm</a>(output.c_str(), lsrc_dilated-&gt;width(), lsrc_dilated-&gt;height(),lsrc_dilated-&gt;buffer());
<a name="l00901"></a>00901 
<a name="l00902"></a>00902     
<a name="l00904"></a>00904     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> ldst_cptbi=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc_dilated-&gt;width(),lsrc_dilated-&gt;height(),lsrc_dilated-&gt;numBands() );
<a name="l00905"></a>00905     <a class="code" href="classkl_copy_split_band_functor.html">klCopySplitBandFunctor&lt;unsigned char&gt;</a> kl_cfpitbi_u8( lsrc_dilated,  ldst_cptbi);
<a name="l00906"></a>00906     kl_cfpitbi_u8();
<a name="l00907"></a>00907     output =  outputPath;   output.append(<span class="stringliteral">&quot;COPYFUNCTION_PIXTOBAND_u8_P3R.pgm&quot;</span>);
<a name="l00908"></a>00908     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a> (output.c_str(), ldst_cptbi-&gt;width(), ldst_cptbi-&gt;height()*3,ldst_cptbi-&gt;buffer());
<a name="l00909"></a>00909 
<a name="l00910"></a>00910     <span class="comment">//Test logical functor - and the first and second bands</span>
<a name="l00911"></a>00911     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_logical_B1=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00912"></a>00912     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_logical_B2=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00913"></a>00913     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_logical_B3=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00914"></a>00914 
<a name="l00915"></a>00915     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> logical_result=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00916"></a>00916         
<a name="l00917"></a>00917     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcflf_B1_u8(lsrc, lsrc_logical_B1,0);
<a name="l00918"></a>00918     klcflf_B1_u8();
<a name="l00919"></a>00919     output =  outputPath;   output.append(<span class="stringliteral">&quot;LOGICAL_IN_B1.pgm&quot;</span>);
<a name="l00920"></a>00920     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), lsrc_logical_B1-&gt;width(), lsrc_logical_B1-&gt;height(),lsrc_logical_B1-&gt;buffer());
<a name="l00921"></a>00921     
<a name="l00922"></a>00922     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcflf_B2_u8(lsrc, lsrc_logical_B2,1);
<a name="l00923"></a>00923     klcflf_B2_u8();
<a name="l00924"></a>00924     output =  outputPath;   output.append(<span class="stringliteral">&quot;LOGICAL_IN_B2.pgm&quot;</span>);
<a name="l00925"></a>00925     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), lsrc_logical_B2-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a1c1a57f455690160e825073e3b297c9c">width</a>(), lsrc_logical_B2-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a700315115a5375ef88c78b311139d7d9">height</a>(),lsrc_logical_B2-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a0b9e8748d6febe81c5803003a38c9b9a">buffer</a>());
<a name="l00926"></a>00926 
<a name="l00927"></a>00927     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcflf_B3_u8(lsrc, lsrc_logical_B3,2);
<a name="l00928"></a>00928     klcflf_B3_u8();
<a name="l00929"></a>00929     output =  outputPath;   output.append(<span class="stringliteral">&quot;LOGICAL_IN_B3.pgm&quot;</span>);
<a name="l00930"></a>00930     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), lsrc_logical_B3-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a1c1a57f455690160e825073e3b297c9c">width</a>(), lsrc_logical_B3-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a700315115a5375ef88c78b311139d7d9">height</a>(),lsrc_logical_B3-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a0b9e8748d6febe81c5803003a38c9b9a">buffer</a>());
<a name="l00931"></a>00931 
<a name="l00932"></a>00932     <a class="code" href="classkl_logical_functor.html">klLogicalFunctor</a> klflf_u8(lsrc_logical_B1, lsrc_logical_B2, logical_result,klLogicalFunctor::LogicalFunctorOperationType::AND);
<a name="l00933"></a>00933     klflf_u8();
<a name="l00934"></a>00934     output =  outputPath;output.append(<span class="stringliteral">&quot;LOGICAL_u8_C1R.pgm&quot;</span>);
<a name="l00935"></a>00935     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), logical_result-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a1c1a57f455690160e825073e3b297c9c">width</a>(), logical_result-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a700315115a5375ef88c78b311139d7d9">height</a>(),logical_result-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a0b9e8748d6febe81c5803003a38c9b9a">buffer</a>());
<a name="l00936"></a>00936 
<a name="l00937"></a>00937 
<a name="l00938"></a>00938     <a class="code" href="classkl_fill_holes_functor.html">klFillHolesFunctor&lt;unsigned char&gt;</a> klfhf_NOT_GREEN_u8(lsrc_logical_B2,255,0);
<a name="l00939"></a>00939     klfhf_NOT_GREEN_u8();
<a name="l00940"></a>00940     output =  outputPath;output.append(<span class="stringliteral">&quot;HOLES_FILLED_B2_u8_C1R.pgm&quot;</span>);
<a name="l00941"></a>00941     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), lsrc_logical_B2-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a1c1a57f455690160e825073e3b297c9c">width</a>(), lsrc_logical_B2-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a700315115a5375ef88c78b311139d7d9">height</a>(),lsrc_logical_B2-&gt;<a class="code" href="classkl_packed_heap_raster_buffer.html#a0b9e8748d6febe81c5803003a38c9b9a">buffer</a>());
<a name="l00942"></a>00942 
<a name="l00943"></a>00943     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> lbackgroundcolor=0;
<a name="l00944"></a>00944     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> lforegroundcolor=255;
<a name="l00945"></a>00945     <span class="keyword">const</span> <a class="code" href="kl__image__buffer_8h.html#ae411c8671aea3ca24d160c5c58aafd88">klRasterBufferPointer</a> lsrc_holefill=<span class="keyword">new</span> <a class="code" href="classkl_packed_heap_raster_buffer.html">klPackedHeapRasterBuffer&lt;unsigned char&gt;</a> (lsrc-&gt;width(),lsrc-&gt;height(),1 );
<a name="l00946"></a>00946     <a class="code" href="classkl_copy_functor.html">klCopyFunctor&lt;unsigned char&gt;</a> klcfhf_u8(lsrc, lsrc_holefill,1);<span class="comment">//Do the first band only</span>
<a name="l00947"></a>00947     klcfhf_u8();
<a name="l00948"></a>00948     <a class="code" href="classkl_fill_holes_functor.html">klFillHolesFunctor&lt;unsigned char&gt;</a> klfhf_u8(lsrc_holefill,lbackgroundcolor,lforegroundcolor);
<a name="l00949"></a>00949     klfhf_u8();
<a name="l00950"></a>00950     output =  outputPath;output.append(<span class="stringliteral">&quot;HOLES_FILLED_u8_C1R.pgm&quot;</span>);
<a name="l00951"></a>00951     <a class="code" href="kl__ppm__image__io_8cpp.html#a59c449d0876be18f00f00c11a3e23836">write_ppm_single_band</a>(output.c_str(), lsrc_holefill-&gt;width(), lsrc_holefill-&gt;height(),lsrc_holefill-&gt;buffer());
<a name="l00952"></a>00952 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Apr 21 2014 10:04:36 for klImageCore by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
